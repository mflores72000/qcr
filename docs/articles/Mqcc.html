<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="qcr">
<title>Gráficos de Control de la calidad Multivariante • qcr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gráficos de Control de la calidad Multivariante">
<meta property="og:description" content="qcr">
<meta property="og:image" content="https://mflores72000.github.io/qcr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">qcr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/Authors.html">
    <span class="fa fa-user"></span>
     
    Authors
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions and Data</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-material-es-">Material (Es)</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-material-es-">
    <a class="dropdown-item" href="../articles/Uqcc.html">Gráficos de control de la calidad univariantes</a>
    <a class="dropdown-item" href="../articles/Npqcc.html">Gráficos de control de la calidad no-paramétricos</a>
    <a class="dropdown-item" href="../articles/Mqcc.html">Gráficos de Control de la calidad Multivariante</a>
    <a class="dropdown-item" href="../articles/CAP.html">Análisis de capacidad de un proceso</a>
    <a class="dropdown-item" href="../articles/material.html">Material Extra</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-material-en-">Material (En)</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-material-en-">
    <a class="dropdown-item" href="../articles/en_material.html">Statisics with qcr package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/Conference.html">Conferences</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mflores72000/qcr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Gráficos de Control de la calidad Multivariante</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mflores72000/qcr/blob/HEAD/vignettes/Mqcc.Rmd" class="external-link"><code>vignettes/Mqcc.Rmd</code></a></small>
      <div class="d-none name"><code>Mqcc.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mflores72000/qcr" class="external-link">qcr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: qcc</span></span>
<span><span class="co">#&gt; Package 'qcc' version 2.7</span></span>
<span><span class="co">#&gt; Type 'citation("qcc")' for citing this R package in publications.</span></span>
<span><span class="co">#&gt; Loading required package: fda.usc</span></span>
<span><span class="co">#&gt; Loading required package: fda</span></span>
<span><span class="co">#&gt; Loading required package: splines</span></span>
<span><span class="co">#&gt; Loading required package: fds</span></span>
<span><span class="co">#&gt; Loading required package: rainbow</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; Loading required package: pcaPP</span></span>
<span><span class="co">#&gt; Loading required package: RCurl</span></span>
<span><span class="co">#&gt; Loading required package: deSolve</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'fda'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:graphics':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     matplot</span></span>
<span><span class="co">#&gt; Loading required package: mgcv</span></span>
<span><span class="co">#&gt; Loading required package: nlme</span></span>
<span><span class="co">#&gt; This is mgcv 1.8-40. For overview type 'help("mgcv-package")'.</span></span>
<span><span class="co">#&gt; ----------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;  Functional Data Analysis and Utilities for Statistical Computing</span></span>
<span><span class="co">#&gt;  fda.usc version 2.0.2 (built on 2020-02-17) is now loaded</span></span>
<span><span class="co">#&gt;  fda.usc is running sequentially usign foreach package</span></span>
<span><span class="co">#&gt;  Please, execute ops.fda.usc() once to run in local parallel mode</span></span>
<span><span class="co">#&gt;  Deprecated functions: min.basis, min.np, anova.hetero, anova.onefactor, anova.RPm</span></span>
<span><span class="co">#&gt;  New functions: optim.basis, optim.np, fanova.hetero, fanova.onefactor, fanova.RPm</span></span>
<span><span class="co">#&gt; ----------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Loading required package: mvtnorm</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Package qcr: Quality Control Review </span></span>
<span><span class="co">#&gt;  version 1.4 (built on 2022-02-15).</span></span>
<span><span class="co">#&gt;  Copyright Miguel A. Flores Sanchez 2016-2022.</span></span></code></pre></div>
<p>En esta sección se utilizan los conjuntos de datos del paquete MSQC
que deben ser de tipo array. Este tipo de dato es una generalización del
tipo de dato data frame o matriz que se maneja en R. En el caso de que
no sea un array el paquete qcr lo transforma de manera automática a
array a través de la función mqcd. A continuación se presentan los
conjuntos de datos que se utilizan para los ejemplos.</p>
<ul>
<li><p>Pasador de una clavija (Dowel pin): Diámetro y longitud de un
proceso de fabricación de un pasador de clavija.</p></li>
<li><p>Target archery: Conjunto de datos de tiro con arco en la ronda de
clasificación. En esta etapa el arquero dispara 72 flechas en 12 fines
de seis flechas. La información que se da en las coordenadas x e y. Es
un array de dimenciones 24 x 2 x 3.</p></li>
</ul>
<div class="section level2">
<h2 id="hotelling">Hotelling<a class="anchor" aria-label="anchor" href="#hotelling"></a>
</h2>
<p>Consideremos un proceso de control en el que se observan <span class="math inline">\(p\)</span> variables que se distribuyen segúnn una
Normal <span class="math inline">\(p\)</span> variante con un vector de
medias <span class="math inline">\(\mu_0=\left(\mu_{01},\mu_{02},\dots,\mu_{0p}\right)\)</span>
y una matriz <span class="math inline">\(\Sigma_0\)</span> de
varianzas-covarianzas de orden <span class="math inline">\(p\)</span>
denotada por <span class="math inline">\(N_p\left(\mu_0,\Sigma_0\right)\)</span>. Se desea
contrastar las hipótesis: <span class="math inline">\(H_0: \mu_i =
\mu_0\)</span> vs. <span class="math inline">\(H_1: \mu_i \ne
\mu_0\)</span> para determinar si el proceso está bajo control. Para
esto se diseñan criterios para determinar si el proceso esta fuera de
control que utilizan el estadístico <span class="math inline">\(T^2\)</span> de Hotelling que dependiendo del
estado de proceso sigue una determinada distribución.</p>
<ul>
<li>Cuando el proceso está bajo control, (<span class="math inline">\(\mu_i = \mu_0\)</span>), existe una probabilidad
<span class="math inline">\(\alpha\)</span> de que el estadístico <span class="math inline">\(T^2_i\)</span> exceda al valor crítico <span class="math inline">\(\mathcal{X}^2_{p,\alpha}\)</span>. Por ello se
toma como indicación o señal de fuera de control un valor del
estadístico <span class="math inline">\(T^2_i\)</span> que supera al
valor <span class="math inline">\(\mathcal{X}^2_{p,\alpha}\)</span>.</li>
</ul>
<p>El estadístico <span class="math inline">\(T^2\)</span> Hotelling
es:</p>
<p><span class="math display">\[T^2_i=n\left( \bar{X}_i-\mu_0\right)^t
\Sigma_0^{-1}\left( \bar{X}_i-\mu_0\right)\]</span></p>
<p>donde <span class="math inline">\(\bar{X}_i=\left(
\bar{X}_{i1},\dots,\bar{X}_{ip}\right)\)</span> es el vector de medias
para las <span class="math inline">\(p-\)</span>características, en la
<span class="math inline">\(i-\)</span>ésima muestra. Cuando el tamaño
del subgrupo <span class="math inline">\(n = 1\)</span>, se obtendrán
vectores de observaciones en lugar de vectores de medias.</p>
<p>En el contexto geométrico, el estadístico <span class="math inline">\(T^2\)</span> es una proporción de la distancia
(Mahalanobis) al cuadrado entre una observación multivariada y el vector
de valores objetivo (vector de media), donde puntos equidistantes forman
elipsoides alrededor de dicho vector. A mayor valor de <span class="math inline">\(T^2\)</span>, mayor es la distancia entre la
observación y el valor objetivo.</p>
<p>Si <span class="math inline">\(\mu_0\)</span> y <span class="math inline">\(\Sigma_0\)</span> son conocidos y el proceso está
bajo control, el estadístico <span class="math inline">\(T^2_i\)</span>
se distribuye como una chi-cuadrado central con <span class="math inline">\(p\)</span> grados de libertad (<span class="math inline">\(T^2_i\approx \mathcal{X}^2_p\)</span>).</p>
<ul>
<li>Cuando el proceso no está bajo control, el estadístico <span class="math inline">\(T^2_i\)</span> se distribuye como una variable
chi- cuadrado no central con <span class="math inline">\(p\)</span>
grados de libertad y con parámetro de no centralidad: <span class="math inline">\(\lambda = n\left( \mu_1-\mu_0\right)^t
\Sigma_0^{-1}\left( \mu_1-\mu_0\right)\)</span>, con <span class="math inline">\(\mu_1 \ne \mu_0\)</span>; donde <span class="math inline">\(\mu_1\)</span> es el vector de medias de las <span class="math inline">\(p\)</span> características, cuando existe un
cambio <span class="math inline">\(d\)</span> en al menos una de las
medias.</li>
</ul>
<p>En la práctica, el valor del estadístico <span class="math inline">\(T^2\)</span> se estima mediante los
correspondientes valores muestrales, dando como resultado la siguiente
expresión: <span class="math display">\[ T^2=n\left(
\bar{X}-\bar{\bar{X}}\right)^t S^{-1}\left(
\bar{X}-\bar{\bar{X}}\right)\]</span></p>
<p>Con distribución bajo la hipótesis nula:</p>
<p><span class="math display">\[T^2 \approx \frac{p\left( m-1\right)
\left(n-1 \right) }{mn-m-p+1}F_{\alpha,p,mn-m-p+1}\]</span></p>
<p>Es decir, el estadístico <span class="math inline">\(T^2\)</span>
sigue apróximadamente en este caso una <span class="math inline">\(F\)</span> de Snedecor con <span class="math inline">\(p\)</span> y <span class="math inline">\(\left(
mn-m-p+1\right)\)</span> grados de libertad, para un nivel de
significación del <span class="math inline">\(\alpha \%\)</span>.</p>
<p>Dado que tanto la distribución <span class="math inline">\(\mathcal{X}^2\)</span> y la <span class="math inline">\(F\)</span> son asimétricas con sesgo a la derecha,
se considera únicamente la expresión para el límite de control superior,
que viene dada por:</p>
<p><span class="math display">\[LCS=\frac{p\left( m-1\right) \left(n-1
\right) }{mn-m-p+1}F_{\alpha,p,mn-m-p+1}\]</span> Para el límite
inferior se considera <span class="math inline">\(LCI=0\)</span></p>
<p>Además, para procesos en los que el <span class="math inline">\(m\)</span> es suficientemente grande, <span class="math inline">\(m&gt;100\)</span>, se puede aproximar este límite
por <span class="math inline">\(LCS=\textit{X}^2_{\alpha,p}\)</span>.</p>
<p>Alt (1985) recomienda usar estos límites en una primera fase, lo que
denomina análisis retrospectivo, para una vez estimado el límite de
control por este medio, calcular un segundo límite para la segunda fase,
la de monotorización del proceso, para ello propone un cambio
consistente en multiplicar por la expresión <span class="math inline">\(\frac{m+1}{m-1}\)</span> obteniendo así una nueva
expresión para el límite de control superior LCS.</p>
<p>En el caso de observaciones individuales, es decir <span class="math inline">\(n=1\)</span>, suponiendo que se tienen un total de
<span class="math inline">\(m\)</span> muestras, para evaluar <span class="math inline">\(p\)</span> variables de control, el
correspondiente gráfico de control se construye mediante:</p>
<p><span class="math display">\[LCS=\frac{p\left( m+1\right) \left(n-1
\right) }{m^2-mp}F_{\alpha,p,m-p}\]</span> <span class="math display">\[LCI=0\]</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dowel1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dowel1</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    40 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ diameter: num  0.492 0.501 0.491 0.492 0.505 0.5 0.497 0.509 0.49 0.499 ...</span></span>
<span><span class="co">#&gt;  $ length  : num  0.988 1.011 1.008 0.97 1.003 ...</span></span>
<span><span class="va">data.mqcd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mqcd.html">mqcd</a></span><span class="op">(</span><span class="va">dowel1</span><span class="op">)</span></span>
<span><span class="va">res.mqcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mqcs.t2.html">mqcs.t2</a></span><span class="op">(</span><span class="va">data.mqcd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.mqcs</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of group statistics:</span></span>
<span><span class="co">#&gt;        V1         </span></span>
<span><span class="co">#&gt;  Min.   :0.09137  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.60154  </span></span>
<span><span class="co">#&gt;  Median :1.66096  </span></span>
<span><span class="co">#&gt;  Mean   :1.95000  </span></span>
<span><span class="co">#&gt;  3rd Qu.:2.64402  </span></span>
<span><span class="co">#&gt;  Max.   :5.34020  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of quality characteristics:  2</span></span>
<span><span class="co">#&gt; Number of samples or observations:  40</span></span>
<span><span class="co">#&gt; Number of observations or sample size:  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean Vector: </span></span>
<span><span class="co">#&gt;  0.500875 1.001825</span></span>
<span><span class="co">#&gt; Covariance Matrix:</span></span>
<span><span class="co">#&gt;          diameter       length</span></span>
<span><span class="co">#&gt; [1,] 4.908654e-05 8.584936e-05</span></span>
<span><span class="co">#&gt; [2,] 8.584936e-05 4.199429e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Control limits: </span></span>
<span><span class="co">#&gt;      lcl      ucl </span></span>
<span><span class="co">#&gt;  0.00000 12.44888 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number beyond limits: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.mqcs</span>, title <span class="op">=</span><span class="st">" Hotelling Control Chart for dowel1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Mqcc_files/figure-html/hotelling-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="gráficos-mcusum">Gráficos MCUSUM<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-mcusum"></a>
</h2>
<p>Los gráficos CUSUM pueden extenderse también al caso multivariante,
aunque no hay una única forma de hacerlo.</p>
<p>Los primeros en realizar estudios en la materia fueron Woodall y
Ncube (1985), usando un esquema basado en múltiples (<span class="math inline">\(p\)</span>) CUSUM univariantes.</p>
<p>Healy (1987) desarrolló un modelo de gráfico CUSUM multivariante
mediante:</p>
<p><span class="math display">\[G_i=max\left\lbrace \left(
G_{i-1}+a^t\left( x_i-\mu_0\right)-0,5\lambda\mu_1 \right),0
\right\rbrace \]</span> Donde:</p>
<ul>
<li>
<span class="math inline">\(\mu_0\)</span>: Vector de medias cuando
el proceso está bajo control</li>
<li>
<span class="math inline">\(\Sigma_0\)</span>: Matriz de
varianzas-covarianzas bajo control</li>
<li>
<span class="math inline">\(\mu_1\)</span>: Vector de medias cuando
el proceso no est’a bajo control</li>
<li>
<span class="math inline">\(\lambda\mu_1\)</span>: Ra’iz cuadrada
del par’ametro de descentrado</li>
<li>
<span class="math inline">\(a^t=\frac{A}{\lambda\mu_1}\)</span>,
<span class="math inline">\(A=\left(\mu_1-\mu_0\right)^t\Sigma_0^{-1}\)</span>
</li>
</ul>
<p>Para interpretar el gráfico se considera que se produce una señal de
alarma cuando <span class="math inline">\(G_i\)</span> supera un cierto
valor de referencia <span class="math inline">\(H\)</span>,
convenientemente elegido y que se encuentra tabulado. Hawkins (1991)
desarrolla un modelo para variables ajustadas mediante regresión
multivariante, en base a la suposición de que cuando se produce un
cambio en la media, se produce de una determinada manera. Concretamente
se asume que el cambio se debe a una variación de magnitud <span class="math inline">\(d\)</span> en la media de una de las
variables.</p>
<p>Otras propuesta de gráficos MCUSUM son los de Croisier (1988) o los
de Pignatiello y Runger (1990). En el paquete qcr se ha implementado el
procedimiento de Croisier que reduce cada observación multivariada a un
escalar y luego construye el estadístico CUSUM con los escalares.</p>
<p>Croisier considera el siguiente estadístico:</p>
<p><span class="math inline">\(T_i=\sqrt{T^2_i}=\sqrt{n\left(
\bar{X}_i-\mu_0\right)^t \Sigma_0^{-1}\left(
\bar{X}_i-\mu_0\right)}\)</span></p>
<p>Crosier considera el estadístico <span class="math inline">\(T\)</span> porque de esa manera, se acumulan
distancias en lugar de distancias al cuadrado. El estadístico MCUSUM se
calcula de la siguiente manera:</p>
<p>%<span class="math display">\[ S_i=max\left\lbrace0,S_{i-1}+T_i-k
\right\rbrace \]</span></p>
<p>donde <span class="math inline">\(S_0\ge 0\)</span> (en general se
considera <span class="math inline">\(S_0=0\)</span>) y <span class="math inline">\(k&gt;0\)</span>.</p>
<p>El gráfico MCUSUM da una señal de fuera de control cuando el valor de
<span class="math inline">\(S_i\)</span> es mayor que un cierto valor
<span class="math inline">\(h\)</span> que depende del valor del <span class="math inline">\(ARL\)</span> deseado cuando el proceso está
funcionando en el valor objetivo <span class="math inline">\(\left[ S_i
&gt; h \right]\)</span>.</p>
<p>Para determinar los valores de h y k para <span class="math inline">\(p = 2, 5,10\)</span> y <span class="math inline">\(20\)</span> y para valores de <span class="math inline">\(ARL\)</span> de <span class="math inline">\(200\)</span> y de <span class="math inline">\(500\)</span> cuando el proceso está bajo control
Crosier empleo procesos de Markov. Estas tablas se diseñaron para
detectar un cambio <span class="math inline">\(d = 1\)</span> en el
vector de medias, donde <span class="math inline">\(d = \lambda\)</span>
, con <span class="math inline">\(\lambda\)</span> parámetro de no
centralidad. En este caso especial los valores de <span class="math inline">\(k\)</span> ’optimos se aproximan a <span class="math inline">\(p\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dowel1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dowel1</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    40 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ diameter: num  0.492 0.501 0.491 0.492 0.505 0.5 0.497 0.509 0.49 0.499 ...</span></span>
<span><span class="co">#&gt;  $ length  : num  0.988 1.011 1.008 0.97 1.003 ...</span></span>
<span><span class="va">data.mqcd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mqcd.html">mqcd</a></span><span class="op">(</span><span class="va">dowel1</span><span class="op">)</span></span>
<span><span class="va">res.mqcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mqcs.mcusum.html">mqcs.mcusum</a></span><span class="op">(</span><span class="va">data.mqcd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.mqcs</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of group statistics:</span></span>
<span><span class="co">#&gt;        V1        </span></span>
<span><span class="co">#&gt;  Min.   :0.0000  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.7749  </span></span>
<span><span class="co">#&gt;  Median :1.1501  </span></span>
<span><span class="co">#&gt;  Mean   :1.3818  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.9987  </span></span>
<span><span class="co">#&gt;  Max.   :3.8409  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of quality characteristics:  2</span></span>
<span><span class="co">#&gt; Number of samples or observations:  40</span></span>
<span><span class="co">#&gt; Number of observations or sample size:  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean Vector: </span></span>
<span><span class="co">#&gt;  0.500875 1.001825</span></span>
<span><span class="co">#&gt; Covariance Matrix:</span></span>
<span><span class="co">#&gt;          diameter       length</span></span>
<span><span class="co">#&gt; [1,] 4.908654e-05 8.584936e-05</span></span>
<span><span class="co">#&gt; [2,] 8.584936e-05 4.199429e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Control limits: </span></span>
<span><span class="co">#&gt; lcl ucl </span></span>
<span><span class="co">#&gt; 0.0 5.5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number beyond limits: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.mqcs</span>, title <span class="op">=</span><span class="st">" MCUSUM Control Chart for dowel1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Mqcc_files/figure-html/mcusum-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="gráficos-mewma">Gráficos MEWMA<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-mewma"></a>
</h2>
<p>El gráfico de medias móviles ponderadas exponencialmente para el caso
multivariante (MEWMA) es una extensión a esta nueva situación del
correspondiente gráfico univariante. La extensión multivariante,
propuesta por Lowry (1992), adopta la forma:</p>
<p><span class="math display">\[Z_i=\Lambda X_i +\left(
I-\Lambda\right)Z_{i-1}\]</span></p>
<p>donde: <span class="math inline">\(X_i\)</span> es el vector de
medias muestrales y <span class="math inline">\(\Lambda\)</span> es la
matriz diagonal formada por los valores <span class="math inline">\(\lambda\)</span> para las distintas variables. Los
<span class="math inline">\(\lambda_j\)</span> marcan la profundidad de
la memoria para cada variable. A mayor valor de <span class="math inline">\(r_j\)</span>, menor profundidad. <span class="math inline">\(I\)</span> es la matriz identidad y se considera
como valor inicial <span class="math inline">\(Z_0=0\)</span>.</p>
<p>La información que proporcionan los <span class="math inline">\(Z_i\)</span> se recoge en el estadístico:</p>
<p><span class="math display">\[T^2_i=Z_i^t\Sigma_{Z_i}^{-1}Z_i\]</span></p>
<p>Donde <span class="math inline">\(\Sigma_{Z_i}^{-1}\)</span> es la
inversa de la matriz de varianzas-covarianzas de los <span class="math inline">\(Z_i\)</span>.</p>
<p>La señal de salida de control se produce cuando <span class="math inline">\(T_i^2\)</span> supera un cierto valor <span class="math inline">\(h\)</span>, (<span class="math inline">\(h&gt;0\)</span>) seleccionado de manera tal de
lograr un cierto valor de <span class="math inline">\(ARL\)</span>
cuando el proceso está bajo control. Si no existe a priori ninguna razón
para ponderar en forma diferente las observaciones pasadas de cada una
de las <span class="math inline">\(p\)</span> variables (como
generalmente sucede), entonces se considera <span class="math inline">\(\lambda_1=\dots=\lambda_p\)</span>.</p>
<p>La matriz <span class="math inline">\(\Sigma_{Z_i}\)</span> puede
obtenerse a partir de los elementos de la matriz de varianzascovarianzas
correspondiente a las variables analizadas mediante la expresi’on:</p>
<p><span class="math display">\[\Sigma_{Z_i}=\frac{\lambda}{2-\lambda}\left[
1-\left( 1-\lambda\right)^{2i} \right]\Sigma_x \]</span></p>
<p>donde <span class="math inline">\(\Sigma_x\)</span> es la matriz de
varianzas-covarianzas original.</p>
<p>Cuando <span class="math inline">\(r=1\)</span>, el gráfico MEWMA
coincide con el gráfico de control <span class="math inline">\(T^2\)</span> dado que el valor asintótico de la
matriz de varianza-covarianza de <span class="math inline">\(Z_i\)</span> es:</p>
<p><span class="math display">\[\Sigma_{Z_i}=\frac{\lambda}{2-\lambda}\Sigma_x
\]</span></p>
<p>En lo que respecta al límite de control (superior) empleado, Runger y
Prabhu (1996) sugieren una aproximación mediante cadenas de Markov, que
permite estudiar el funcionamiento del gráfico referente al <span class="math inline">\(ARL\)</span>. Proporcionan además una serie de
recomendaciones para la selección de los par’ametros del gráfico.</p>
<p>En lo que se refiere al parámetro <span class="math inline">\(\lambda\)</span>, Montgomery (1991) recomienda que
su valor está comprendido entre 0.05 y 0.25. Cuanto mayor sea el valor
del parámetro, menor importancia se le estará dando a los valores más
alejados en el tiempo. En aplicaciones prácticas se elige 0.1 como el
valor del parámetro <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dowel1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dowel1</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    40 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ diameter: num  0.492 0.501 0.491 0.492 0.505 0.5 0.497 0.509 0.49 0.499 ...</span></span>
<span><span class="co">#&gt;  $ length  : num  0.988 1.011 1.008 0.97 1.003 ...</span></span>
<span><span class="va">data.mqcd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mqcd.html">mqcd</a></span><span class="op">(</span><span class="va">dowel1</span><span class="op">)</span></span>
<span><span class="va">res.mqcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mqcs.mewma.html">mqcs.mewma</a></span><span class="op">(</span><span class="va">data.mqcd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.mqcs</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of group statistics:</span></span>
<span><span class="co">#&gt;        V1         </span></span>
<span><span class="co">#&gt;  Min.   :0.04165  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.95586  </span></span>
<span><span class="co">#&gt;  Median :1.69276  </span></span>
<span><span class="co">#&gt;  Mean   :1.62204  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.89606  </span></span>
<span><span class="co">#&gt;  Max.   :4.17595  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of quality characteristics:  2</span></span>
<span><span class="co">#&gt; Number of samples or observations:  40</span></span>
<span><span class="co">#&gt; Number of observations or sample size:  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean Vector: </span></span>
<span><span class="co">#&gt;  0.500875 1.001825</span></span>
<span><span class="co">#&gt; Covariance Matrix:</span></span>
<span><span class="co">#&gt;          diameter       length</span></span>
<span><span class="co">#&gt; [1,] 4.908654e-05 8.584936e-05</span></span>
<span><span class="co">#&gt; [2,] 8.584936e-05 4.199429e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Control limits: </span></span>
<span><span class="co">#&gt;    lcl    ucl </span></span>
<span><span class="co">#&gt; 0.0000 8.6336 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number beyond limits: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.mqcs</span>, title <span class="op">=</span><span class="st">" MEWMA Control Chart for dowel1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Mqcc_files/figure-html/mewma-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Miguel Flores, Ruben Fernandez-Casal, Salvador Naya, Javier Tarrio-Saavedra.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
