<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="qcr">
<title>English Material • qcr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="English Material">
<meta property="og:description" content="qcr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">qcr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions and Data</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-material-es-">Material (Es)</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-material-es-">
    <a class="dropdown-item" href="../articles/Uqcc.html">Gráficos de control de la calidad univariantes</a>
    <a class="dropdown-item" href="../articles/Npqcc.html">Gráficos de control de la calidad no-paramétricos</a>
    <a class="dropdown-item" href="../articles/Mqcc.html">Gráficos de Control de la calidad Multivariante</a>
    <a class="dropdown-item" href="../articles/CAP.html">Análisis de capacidad de un proceso</a>
    <a class="dropdown-item" href="../articles/material.html">Material Extra</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-material-en-">Material (En)</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-material-en-">
    <a class="dropdown-item" href="../articles/en_material.html">Statisics with qcr package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mflores72000/qcr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="en_material_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>English Material</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mflores72000/qcr/blob/HEAD/vignettes/en_material.Rmd" class="external-link"><code>vignettes/en_material.Rmd</code></a></small>
      <div class="d-none name"><code>en_material.Rmd</code></div>
    </div>

    
    
<p><strong>Abstract:</strong> This work introduces and describes the <code>R</code> package <code>qcr</code> for Statistical Quality Control (SQC). The <code>qcr</code> package includes a comprehensive set of univariate and multivariate SQC tools that completes and increases the SQC techniques available in <code>R</code>. It combines traditional and new exible SQC procedures to manage real quality control problems in industry and consulting. Apart from integrating diferent <code>R</code> packages devoted to SQC (<code>qcc</code>, <code>MSQC</code>), <code>qcr</code> provides new nonparametric tools that are highly useful when Gaussian assumption is not met. This package provides a comprehensive set of functions in <code>R</code> to programme attribute and variable control charts, from a parametric and nonparametric point of view, in a univariate or multivariate way. In order to be applied in real industry problems, <code>qcr</code> estimates the natural control limits and monitor critical variables in a practical and automatic way. The proposed package computes standard univariate control charts for individual measurements, <span class="math inline">\(\bar{x}, S, R, p, np, c, u, EWMA\)</span> and <span class="math inline">\(CUSUM\)</span>. In addition, it includes functions to perform multivariate control charts such as Hotelling T2, MEWMA and MCUSUM. Moreover, new nonparametric alternatives based on data depth are implemented in this package: <span class="math inline">\(r, Q\)</span> and <span class="math inline">\(S\)</span> control charts. Consequently, robust alternatives of capability indices are now available in <code>R</code> through <code>qcr</code> library. The <code>qcr</code> library also estimates the most complete set of capability indices from first to fourth generation, and performing the corresponding capability analysis graphical outputs, including the process capability plots.</p>

<p><strong>Keywords:</strong> statistical quality control, Shewhart control charts, multivariate control charts, nonparametric control charts, data depth, capability index, <code>R</code>.</p>

<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Throughout the last decades, there has been an increasing interest to measure, improve and control the quality of products, services and procedures. This is connected to the strong relationship between quality, productivity, prestige, trust and brand image. In fact, implementing procedures of statistical quality control (SQC) are currently related to increasing companies’ competitiveness. The concept of quality control has been extended from the first definitions based on the idea of adjusting production, to a standard model to satisfy customer requirements and include all participants. Nowadays, SQC is not only applied to manufactured products but to all industrial and service processes. The use of diferent SQC techniques were standarized With the development of the Six Sigma method by Motorola in 1997 . Six Sigma is a methodology or even philosophy focused on the variability reduction that promotes the use of statistical methods and tools in order to improve processes in industry and services. Six Sigma’s goal is to reach maximum 3.4 defects per million of events or opportunities (DPMO) meeting the customer requirements. The Six Sigma application is composed by five stages: Define, Measure, Analyze, Improve, and Control (DEMAIC). The Six Sigma methodology itself indicates which technique to apply at each stage of the improvement process. The Figure  shows some representative statistical techniques applied in each of the Six Sigma stages. The two most representative statistical tools of SQC are the control charts and the process capabity analysis . Therefore, the proposed <code>qcr</code> package has been developed in order to provide users an exhaustive, comprehensive and free set of programming tools to apply control charts and perform capability analysis in the SQC framework.</p>
<p>
</p>
<p>The control stage is characterized by the use of tools based on anomaly detection and correction . The most representative techniques of this stage and the primary tool of the Statistical Process Control (SPC) are the control charts . They have been developed to evaluate the process performance and at any time. The use of control charts prevents the process getting out of control, and helping to detect the assignable causes corresponding to variations of the critical-to-quality features (CTQs), thus performing process changes when actually required. Furthermore, control charts provide estimates of the natural range of process variation (natural control limits), allowing us to compare this range with those limits specified by standards, company managers or customers (specification limits). Hence, the process monitoring can be carried out by comparing each new observation with these natural limits, preventing defects in the final product. Briefly, a control chart is a two dimensional graph whose axis represents the variable or attribute that is being monitored (CTQ variables). They were introduced by Shewhart in 1924 at Bell laboratories. The estimation of natural control limits of the CTQ variables is developed by a process composed of two phases: In Phase I, the natural control limits are estimated using a preliminary sample (calibration sample) where we assume that the causes of variation are only random. In Phase II, each new observation is plotted on the control chart along with the natural limits obtained in the previous step. The set of new observations (twhich are not used to calculate the natural control limits) make up the so-called monitoring sample. Patterns, observations of out of control limits, runs of more than six observations on one side of the central line, among others, are some of the diferent criteria to identify out of control states in a specific process, providing also valuable information about the detection of any assignable causes of variation in the monitoring.</p>
<p>
</p>
<p>
</p>
<p><span class="math inline">\(~~~~~~\)</span>The most used control charts are based on the assumptions of normality and independence of the studied CTQ variables. These charts are used to control position and dispersion of CTQ attributes and variables. Figure  shows some of the most important types of control charts. These can be classified according to the type of feature that is being controlled (attribute or variable), the variable dimension (univariate or multivariate), and assuming or not a parametric 65 distribution of the variable (parametric or nonparametric).</p>
<p>The <code>qcr</code> package provides charts for the mean (<span class="math inline">\(\bar{x}\)</span>), standard deviation (<span class="math inline">\(s\)</span>), range (<span class="math inline">\(R\)</span>), individual measurements (<span class="math inline">\(I\)</span>), moving ranges (<span class="math inline">\(MR\)</span>), proportion of nonconforming units (<span class="math inline">\(p\)</span>), number of nonconforming units (<span class="math inline">\(np\)</span>), number of defects per unit (<span class="math inline">\(c\)</span>), mean number of defects per control unit (<span class="math inline">\(u\)</span>), exponentially weighted moving average (EWMA), and cumulative sum control chart (CUSUM). The last two techniques are also called memory control charts and they are the specially designed to detect shifts of less than two standard deviations, both when using rational samples or individual measurements. On the other hand, new control charts based on the concept of data depth and developed by  are implemented in <code>qcr</code>. Those are the <span class="math inline">\(r, Q\)</span> and <span class="math inline">\(S\)</span> control charts, the nonparametric alternatives for individual measurements, mean control chart and CUSUM control chart, respectively. When more than one variable defines the process quality, multivariate control charts are applied. If the Gaussian assumption is met, Hotelling T<span class="math inline">\(^2\)</span> control chart can be applied. If we want to detect small deviations, multivariate EWMA (MEWMA) and multivariate CUSUM (MCUSUM) can be implemented. When no parametric distribution is assumed, <span class="math inline">\(r, Q\)</span> and <span class="math inline">\(S\)</span> charts can be used.</p>
<p>
</p>
<p>Another interesting SQC tool, which is very useful in industry, is the Process Capability Analysis (PCA). It estimates how well a process meets the tolerances defined by the company, customers, standards, etc., by comparing the specification tolerances with respect to the natural range of variation of CTQ features. The process capability is measured using capability indicators, Process Capability Ratio (PCR) is a numerical score that helps the manufacturers know whether the output of a process meets the engineering specifications. Large PCR values show that the industrial or service process is capable of meeting the customer requirements. There have been many diferent PCRs developed in the last four decades that require the Gaussian assumption for the CTQ variable . But many processes in industry and real applications do not meet this hypothesis, thus we could innacuratelly estimate the capability using PCR, hence many authors have studied diferent nonparametric alternatives to traditional PCR .</p>
<p>
</p>
<p>The <code>qcr</code> package has been developed in <code>R</code>  under the 90 GNU license. Nowadays there are other <code>R</code> packages that currently provide quality control tools for users. The use of each one is shown in Figure . The <code>qcc</code> package  was developed by Professor Luca Scrucca of the Department of Economics, Finance and Statistics at the University of Perugia. It enables us to perform Shewhart quality control charts for variables and attributes, as well as the CUSUM and EWMA charts for detecting small changes in the CTQ variable. Multivariate analysis is performed applying the Hotelling T<span class="math inline">\(^2\)</span> control chart. Additionally, it has functions implemented to obtain the operating characteristic curves (OC) and to estimate process capability analysis indices. Pareto and Ishikawa diagrams are also implemented. Otherwise, the <code>IQCC</code> package  is maintained by Professor Emanuel P. Barbosa of the Institute of Mathematics in the State University of Campinas. It has a smaller number of control charts implemented but it incorporates multivariate graphics. The <code>qualityTools</code> package  was developed to aid learning in quality sciences. The Figure  shows some of its utilities, e.g. capability analysis (providing a comprehensive set of parametric distributions) and design of experiments. In addition, the SixSigma library  provides alternative functions to <code>qualityTools</code> and <code>qcc</code> packages, and the possibility of 104 implementing process maps.</p>
<p><span class="math inline">\(~~~~~~\)</span>Furthermore, there are other libraries specifically focused on control chart applications. Namely, the spcadjust  that allows us to estimate the calibration control limits of Shewhart, CUSUM and EWMA control charts, and the <code>spc</code>  which provides tools for the evaluation of EWMA, CUSUM and Shiryaev-Roberts control charts by using Average Run Length and RL quantiles criteria. Moreover, the <code>MSQC</code> package  is a set of tools for multivariate process control, mainly control charts. It contains the main alternatives for multivariate control charts such as Hotelling (T<span class="math inline">\(^2\)</span>), Chi squared, MEWMA, MCUSUM and Generalized Variance control charts. It also includes some tools to evaluate the multivariate normal assumption. The corresponding multivariate capability analysis can be performed using the <code>MPCI</code> library  that provides diferent multivariate capability indices. It is also interesting to mention the <code>edcc</code> package  for its ecomomic design of control charts by minimizing the expected cost per hour of the studied process.</p>
<p>
</p>
<p>
</p>
<p><span class="math inline">\(~~~~~~\)</span>In this article, the new qcr library, which implements a great deal of the statistical tools for quality control, is presented. The aim is to provide the scientific community and quality assurance users a computer application that allows simple and eficient handling of statistical tools for quality control, which are fundamental techniques in the Six Sigma methodology: control charts for variables and attributes, and capability analysis. It is important to emphasize that the <code>qcr</code> package also includes new applications such as nonparametric approaches of control charts and capability indices, which are currently unavailable in the <code>R</code> software.</p>
</div>
<div class="section level2">
<h2 id="datasets-in-the-qcr-package">Datasets in the <code>qcr</code> package<a class="anchor" aria-label="anchor" href="#datasets-in-the-qcr-package"></a>
</h2>
<p>The qcr package contains new databases (see table ) based on study cases tackled by the authors during their professional activity as well as well-known datasets implemented on other packages focused on statistical quality control such as:</p>
<ul>
<li><p><strong>archery1:</strong> It consists of a stage in which the archer shoots 72 arrows. The information is given in x and y coordinates. It is implemented in the <code>MSQC</code> package (Santos-Fernandez ).</p></li>
<li><p><strong>circuit:</strong> Number of nonconformities observed in 26 successive samples of 100 printed circuit boards. It is implemented in the <code>qcc</code> package (Scrucca ).</p></li>
<li><p><strong>dowel1:</strong> Diameter and length of a dowel pin. It is implemented in the <code>MSQC</code> package (Santos-Fernandez ).</p></li>
<li><p><strong>orangejuice:</strong> Frozen concentrated orange juice is packed in 6-oz cartons. These cartons are formed on a machine by spinning them from a cardboard stock and attaching a metal bottom panel. A can is then inspected to determine whether, when filled, the liquid could possibly leak either on the side seam or around the bottom joint. If this occurs a can is considered nonconforming. The data were collected as 30 samples of 50 cans each at half-hour intervals over a three-shift period in which the machine was in continuous operation. It is implemented in the <code>qcc</code> package (Scrucca ).</p></li>
<li><p><strong>pcmanufact:</strong> A personal computer manufacturer counts the number of nonconformities per unit on the final assembly line. He collects data on 20 samples of 5 computers each. It is implemented in the qcc package (Scrucca ).</p></li>
<li><p><strong>pistonrings:</strong> Piston rings for an automotive engine are produced by a forging process. The inside diameter of the rings manufactured by the process is measured on 25 samples, each of size 5, drawn from a process being considered ‘in control’. It is implemented in the <code>qcc</code> package (Scrucca ).</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="univariate-statistical-quality-control-with-shewhart-control-charts">Univariate statistical quality control with Shewhart control charts<a class="anchor" aria-label="anchor" href="#univariate-statistical-quality-control-with-shewhart-control-charts"></a>
</h2>
<p><span class="math inline">\(~~~~~~\)</span>The control chart is a useful tool in statistical process control for monitoring and controlling manufacturing processes . It is an on-line process control technique used for detecting the occurrence of any significant process mean (or variability) change and, accordingly, calling for a corrective action. The construction of a control chart is equivalent to the plotting of the acceptance regions of a sequence of hypothesis tests over time. Namely, the <span class="math inline">\(\bar{x}\)</span> chart is a control chart used to monitor the process mean <span class="math inline">\(\mu\)</span>. It plots the sample means, <span class="math inline">\(\bar{X}\)</span>’s, corresponding to subgroups of the <span class="math inline">\(\{X_1,X_2, \ldots\}\)</span> observations and is equivalent to test the hypotheses <span class="math inline">\(H_0 : \mu = \mu_0\)</span> versus <span class="math inline">\(H_{\alpha} : \mu \neq \mu0\)</span> (for some target value <span class="math inline">\(\mu_0\)</span>) conducted over time, using <span class="math inline">\(\bar{x}\)</span> as the test statistic. Here we assume that <span class="math inline">\(\{X_1,X_2, \ldots\}\)</span> are the sample measurements of a particular CTQ feature that follows the <span class="math inline">\(F\)</span> distribution with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>. When there is insuficient evidence to reject <span class="math inline">\(H_0\)</span>, we can state that the process is under control; otherwise, the process is out of control. In other words, processes are under control when their sources of variation are only the sources common to the process . The decision to reject or not <span class="math inline">\(H_0\)</span> is based on the value of the sample mean <span class="math inline">\(\bar{x}\)</span> observed at each time interval . The control charts are easy to construct, visualize, and interpret, and most important, have proven their efectiveness in practice since the 1920’s.</p>
<div class="section level3">
<h3 id="definition-of-univariate-quality-control-objects-and-statistics">
<em>Definition of univariate quality control objects and statistics</em><a class="anchor" aria-label="anchor" href="#definition-of-univariate-quality-control-objects-and-statistics"></a>
</h3>
<p><span class="math inline">\(~~~~~~\)</span>Control charts are defined, on the one hand, by a center line that represents the average value of the the <code>CTQ</code> feature corresponding to the in-control state and, on the other hand, two horizontal lines, called the upper control limit (UCL) and the lower control limit (LCL). The region between the control limits corresponds to the region where <span class="math inline">\(H_0\)</span> is not rejected (defined in the previous section).</p>

<p>As a consequence, the process will be out of control when an observed rational sample or an individual measurement falls outside the limits. This suggests that the studied process may have been afected by some special or assignable causes, out of the common ones. Even although all the observations (rational samples or individual measurements) were inside the control limits, the process could be out of control if the points which represent them in the control chart follow systematic patterns. Consequently, diferent methods such as the Western Electric rules have been developed in order to identify those sequences or non random patterns in a control chart, and therefore helping to detect out of control states . In conclussion, control charts are a very useful tool to detect shifts with respect to the probability distribution that defines the state under control (and characterizes the quality level) of a process, whenever using the proper estimated control limits.</p>
<p>
</p>
<p>
</p>
<p><span class="math inline">\(~~~~~~\)</span>Let <span class="math inline">\(w\)</span> be a sample statistic that measures a quality characteristic of interest, and suppose that the mean of <span class="math inline">\(w\)</span> is <span class="math inline">\(\mu_w\)</span> and the standard deviation of <span class="math inline">\(w\)</span> is <span class="math inline">\(\sigma_w\)</span>. Then the center line, the upper control limit, and the lower control limit become:</p>
<p><span class="math display">\[\begin{align*}
\mbox{UCL} &amp; = \mu_{w}+ L\sigma_{w}\\
\mbox{CL} &amp; = \mu_{w}\\
\mbox{LCL} &amp; = \mu_{w}- L\sigma_{w}
\end{align*}\]</span></p>
<p>Where <span class="math inline">\(L\)</span> is the “distance” of the control limits from the center line, expressed in standard deviation units. In designing a control chart, the sample size and sampling frequency must be specified. Small shifts in the process will be detected much easier when large samples are measured. Taking large samples would be the desirable situation, but it is not feasible in many cases either from an economic point of view or by the characteristics of the process studied. The Average Run Length (ARL) allows us to choose the rational sample size and sampling frequency. It is defined by the number of rational samples that, on average, is necessary to monitor and plot in a control chart before an out of control state is identified. If the observations obtained from the CTQ feature of the process are not correlated, the ARL can be estimated using the Shewhart control charts by the expression</p>
<p><span class="math display">\[\begin{align*}
\mbox{ARL} &amp; = \frac{1}{p}
\end{align*}\]</span></p>
<p>where <span class="math inline">\(p\)</span> is the probability that any point exceed the natural control limits. The performance of the control charts can be evaluated using this equation, although sometimes it is recommended to express the control chart performance in terms of its Average Time to Signal (ATS), which is defined as</p>
<p><span class="math display">\[\begin{align*}
\mbox{ATS} &amp; = \mbox{ARL}\times h\\
\end{align*}\]</span></p>
<p>whereby <span class="math inline">\(h\)</span> is the fixed time interval in which samples are taken.</p>
<p>The functions that compute the quality control statistics for the diferent univariate control charts (involving continuous, attribute or count data) are shown in Table . More details are given in the following sections.</p>

</div>
<div class="section level3">
<h3 id="statistical-quality-control-with-shewhart-control-charts">Statistical quality control with Shewhart control charts<a class="anchor" aria-label="anchor" href="#statistical-quality-control-with-shewhart-control-charts"></a>
</h3>
<p>Control charts can also be divided into two categories. If the CTQ feature of a specific process can take an infinite number of values in a continuous interval, it is called variable, and the corresponding charts are named control charts for variables. Otherwise, if the CTQ feature is not measured in a continuous scale, namely we only can tag each unit of product either as conforming or nonconforming on the basis of whether or not it possesses certain attributes, or alternatively we may count the number of nonconformities (defects) appearing on a unit of product, we are talking about attributes and attribute control charts.</p>
<p>
</p>
<p>In order to illustrate the use of the <code>qcr</code> package, control charts for variables and attributes will be plotted, the construction of control limits will be specified in each section. The first steps are loading both the package and the dataset</p>
<p><br></p>
<p><code>R&gt; library("qcr")</code></p>
<p><code>R&gt; data("pistonrings")</code></p>
<p><br></p>
<p>The <strong>pistorings</strong> data frame consists of 200 observations measured in 25 samples each one of size 5.</p>
<div class="section level4">
<h4 id="control-charts-for-x-bar-r-and-s">Control charts for <code>X-bar</code>, <code>R</code> and <code>S</code><a class="anchor" aria-label="anchor" href="#control-charts-for-x-bar-r-and-s"></a>
</h4>
<p>When working with CTQ variables, monitoring both their mean and variability is necessary. Hence, the <span class="math inline">\(\bar{x}\)</span> chart is used to control the process mean while the process variability can be monitored with the control chart for the range, so called <code>R</code> control chart. Taking into account that the control limits of the <span class="math inline">\(\bar{x}\)</span> chart depend on the process variability estimation, it is recommended to develop the <code>R</code> chart in advance. After assessing the process is in control in terms of variability, these estimates can be used to obtain the natural control limits of the <span class="math inline">\(\bar{x}\)</span> chart in a more reliable way. Supposing that <span class="math inline">\(i = 1, \ldots, k\)</span> rational samples of size <span class="math inline">\(n\)</span> are avaliable, and let <span class="math inline">\(R_i\)</span> be the range of the <span class="math inline">\(i\)</span>th sample. The center line and control limits of the <code>R</code> chart are as follows:</p>
<p><span class="math display">\[\begin{align*}
\mbox{LCL} &amp; = D_3R\\
\mbox{CL} &amp; = R\\
\mbox{UCL} &amp; = D_4R
\end{align*}\]</span></p>
<p>whereby <span class="math inline">\(D_4\)</span> and <span class="math inline">\(D_3\)</span> are constants tabulated for diferent values of <span class="math inline">\(n\)</span> , and <span class="math inline">\(\bar{R}=\frac{1}{k}\sum_{i}R_i\)</span> is the average of the <span class="math inline">\(k\)</span> ranges. In <code>R</code>, these control limits, as well as the center line, are computed using the <code><a href="../reference/qcs.R.html">qcs.R()</a></code> function, and the resulting object may be printed by using the summary function</p>
<p><code>R&gt; x &lt;- droplevels(pistonrings[1:125, ])</code></p>
<p><code>R&gt; res.qcs &lt;- qcs.R(x, data.name = "pistonrings", std.dev = "UWAVE-R")</code></p>
<p><code>R&gt; summary(res.qcs)</code></p>
<pre><code><span class="co">#&gt; R chart for pistonrings </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Summary of group statistics:</span>
<span class="co">#&gt;        R          </span>
<span class="co">#&gt;  Min.   :0.00800  </span>
<span class="co">#&gt;  1st Qu.:0.01800  </span>
<span class="co">#&gt;  Median :0.02100  </span>
<span class="co">#&gt;  Mean   :0.02276  </span>
<span class="co">#&gt;  3rd Qu.:0.02600  </span>
<span class="co">#&gt;  Max.   :0.03900  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Group sample size:  5</span>
<span class="co">#&gt; Number of groups:  25</span>
<span class="co">#&gt; Center of group statistics:  0.02276</span>
<span class="co">#&gt; Standard deviation:  0.009785039 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Control limits: </span>
<span class="co">#&gt;  LCL        UCL</span>
<span class="co">#&gt;    0 0.04812533</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number beyond limits: 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number violationg runs: 0</span></code></pre>
<p>The corresponding chart can be generated with the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method</p>
<p><code>R&gt; plot(res.qcs, title = "Control chart for pistonrings: R")</code></p>
<p>(see Figure ). As there are not patterns, runs, nor samples out of the natural control limits, the process is assumed under control in terms of variability.</p>
<p>Once the variability is controled, <span class="math inline">\(\sigma\)</span> can be estimated by using its unbiased estimator <span class="math inline">\(\hat{\sigma}=\frac{1}{d_2}\bar{R}\)</span>, where <span class="math inline">\(d_2\)</span> is a constant tabulated for various sample sizes . Consequently, the process mean can be controled by an <span class="math inline">\(\bar{x}\)</span> chart, considering the <span class="math inline">\(3\sigma\)</span> control limits</p>
<p><img src="en_material_files/figure-html/unnamed-chunk-3-1.png" width="60%" style="display: block; margin: auto;"></p>
<p><span class="math display">\[\begin{align*}
\mbox{LCL} &amp; = \bar{x} - \frac{3}{\sqrt{n}d_2}\bar{R}=\bar{x}-A_2\bar{R}\\
\mbox{CL} &amp; = \bar{x} \\
\mbox{UCL} &amp; = \bar{x} + \frac{3}{\sqrt{n}d_2}\bar{R}=\bar{x}+A_2\bar{R} 
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\bar{x}=\frac{1}{k}\sum_{i}\bar{x_i}\)</span> is the global mean. The null hypothesis of process in control is tested by assessing if each <span class="math inline">\(\bar{x_i}\)</span> is within the interval <span class="math inline">\([LCL,UCL]\)</span>. Assuming the measured variable is Gaussian and that the process is under control, the probability a point being within the natural control limits is 0.9973. In <code>R</code>, function <code><a href="../reference/qcs.xbar.html">qcs.xbar()</a></code> can be applied to compute the center line and the control limits using the range for estimating the theoretical standard deviation. The corresponding chart can be generated with the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method</p>
<p><code>R&gt; res.qcs &lt;- qcs.xbar(x, data.name = "pistonrings", std.dev = "UWAVE-R")</code></p>
<p><code>R&gt; plot(res.qcs, title = expression(paste("Control chart for pistonrings: ",+ bar(x))))</code></p>
<p>(see Figure ). As shown, there is no evidence that indicates the process is out of control.</p>
<p><img src="en_material_files/figure-html/unnamed-chunk-4-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>The process standard deviation can also be estimated using the sample standard deviation instead of the sample range. This leads to control charts for <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(s\)</span>, where <span class="math inline">\(s\)</span> is the sample standard deviation, and to apply the s control chart instead of the <code>R</code> chart, whose center line and control limits are</p>
<p><span class="math display">\[\begin{align*}
\mbox{LCL} &amp; = B_3\bar{s}\\
\mbox{CL} &amp; = \bar{s} \\
\mbox{UCL} &amp; = B_4\bar{s}
\end{align*}\]</span></p>
<p>whereby <span class="math inline">\(B_3\)</span> and <span class="math inline">\(B_4\)</span> are tabulated constants which depend on <span class="math inline">\(n\)</span> , and <span class="math inline">\(\bar{s}=\frac{1}{k}\sum_{i}s_i\)</span> is the average of the <span class="math inline">\(k\)</span> standard deviations. For this purpose, the <code>qcs.S</code> function can be used in <code>R</code>.</p>
<p>In this case, assuming that variability is controlled, <span class="math inline">\(\sigma\)</span> is estimated by using its unbiased estimator <span class="math inline">\(\hat{\sigma}=\frac{1}{c_4}\bar{s}\)</span>. The <span class="math inline">\(3\sigma\)</span> natural control limits for monitoring the process mean are</p>
<p><span class="math display">\[\begin{align*}
\mbox{LCL} &amp; = \bar{x} - \frac{3}{\sqrt{n}c_4}\bar{s}=\bar{x}-A_3\bar{s}\\
\mbox{CL} &amp; = \bar{x} \\
\mbox{UCL} &amp; = \bar{x} + \frac{3}{\sqrt{n}c_4}\bar{s}=\bar{x}+A_3\bar{s}
\end{align*}\]</span></p>
<p>which also can be programmed in <code>R</code> by using the <code><a href="../reference/qcs.xbar.html">qcs.xbar()</a></code> function, specifying <code>std.dev = "UWAVE-SD"</code> to use the sample standard deviation.</p>
</div>
<div class="section level4">
<h4 id="p-and-np-control-charts">p and np control charts<a class="anchor" aria-label="anchor" href="#p-and-np-control-charts"></a>
</h4>
<p>The <span class="math inline">\(p\)</span> and <span class="math inline">\(np\)</span> charts are the more representative types of atribute control charts. If <span class="math inline">\(k\)</span> random samples of <span class="math inline">\(n\)</span> items are avaliable, and denoting with <span class="math inline">\(X_i\)</span> the number of defective items in each sample, assuming that an item is nonconforming with probability <span class="math inline">\(p\)</span> and also that the items successively produced are independent, the nonconfomities follow a binomial distribution with mean <span class="math inline">\(np\)</span> and standard deviation <span class="math inline">\(\sqrt{np(1\mbox{-}p)}\)</span>. Alternatively, the sample nonconforming item fraction <span class="math inline">\(\hat{p}_i =\frac{X_i}{n}\)</span> has mean <span class="math inline">\(p\)</span> and standard deviation <span class="math inline">\(\sqrt{p(1\mbox{-}p)/n}\)</span>. In both cases the asymptotic distribution is normal, from which the center line and control limits of the Shewhart chart can be worked out. For the <span class="math inline">\(p\)</span> control chart, they are given by</p>
<p><span class="math display">\[\begin{align*}
\mbox{LCL} &amp; = \bar{p} - 3\sqrt{\frac{\bar{p}(1-\bar{p})}{n}}\\
\mbox{CL} &amp; = \bar{p} \\
\mbox{UCL} &amp; = \bar{p} + 3\sqrt{\frac{\bar{p}(1-\bar{p})}{n}} 
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\bar{p}=\frac{1}{k}\sum_{i}p_i\)</span> is the estimate of the unknown propability <span class="math inline">\(p\)</span>.</p>
<p>To illustrate the computation of the n control charts, the orangejuice dataset  (described in Section 1) will be considered. The <code><a href="../reference/qcs.p.html">qcs.p()</a></code> function can be used to compute statistics required for the <span class="math inline">\(p\)</span> chart. It can be directly applied to the data</p>
<p><code>R&gt; data("orangejuice")</code></p>
<p><code>R&gt; res.qcs &lt;- qcs.p(orangejuice[orangejuice$trial, 1:2], +</code></p>
<p><span class="math inline">\(~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\)</span><code>sizes = orangejuice$size[orangejuice$trial])</code></p>
<p>or alternatively, a <code>qcd</code> object (quality control data) could be created first</p>
<p><code>R&gt; datos.qcd &lt;- qcd(data = orangejuice[orangejuice$trial, ], var.index = 1,</code></p>
<p><span class="math inline">\(~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\)</span><code>+ sample.index = 2, sizes = orangejuice$size, type.data = "atributte")</code></p>
<p><code>R&gt; res.qcs &lt;- qcs.p(datos.qcd)</code></p>
<p><code>R&gt; plot(res.qcs, title = "Control chart for orangejuice: p")</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-5-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>The resulting chart is shown in Figure . Samples 6 and 20 are outside the control limits and should be removed from the control limit calculations since assignable causes have been found. Namely, sample 6 was examined by an inexperienced inspector who overlooked several types of nonconformities. In addition, the large number of nonconformities in sample 20 was due to a problem of temperature control in the welding machine .</p>
<p>
</p>
<p>If the objective is to analyze the average number of nonconformities rather than their proportion, the <span class="math inline">\(np\)</span> charts can be used. The statistics for this chart can be computed in <code>R</code> with the <code><a href="../reference/qcs.np.html">qcs.np()</a></code> function. There are other alternatives to perform control of attributes such as the <span class="math inline">\(c\)</span> and <span class="math inline">\(u\)</span> charts, based on Poisson distribution. The <span class="math inline">\(c\)</span> chart controls the total number of defects per unit, whereas the <span class="math inline">\(u\)</span> chart controls the average number of nonconformities per unit. Both can be computed with the <code>qcr</code> package as shown in .</p>
</div>
<div class="section level4">
<h4 id="cusum-chart">CUSUM chart<a class="anchor" aria-label="anchor" href="#cusum-chart"></a>
</h4>
<p>Cumulative sum control charts (CUSUM), proposed by  to monitor the process mean, may now be developed both for individual observations and for the averages of rational subgroups. Its use is specially recommended to identify changes less than <span class="math inline">\(2\sigma\)</span>. The <span class="math inline">\(s_r\)</span> statistic is used to determine whether the process is in control or not. It is defined by</p>
<p><span class="math display">\[\begin{align*}
s_r=\displaystyle\sum_{i=1}^{r}(\bar{x}_1-\mu_0)
\end{align*}\]</span></p>
<p>whereby <span class="math inline">\(\mu_0\)</span> is the target for the process mean. Under Gaussian assumption, the center line and control limits of the chart can be deduced from <span class="math inline">\(s_r\sim N\left(r(\mu-\mu_0),\frac{r\sigma_{0}^{2}}{n}\right)\)</span> Considering again the pistorings dataset, this chart can be analogously generated</p>
<p><code>R&gt; res.qcd &lt;- qcd(pistonrings, type.data = "dependence")</code></p>
<p><code>R&gt; res.qcs &lt;- qcs.cusum(res.qcd, type = "cusum")</code></p>
<p><code>R&gt; plot(res.qcs, title = "Control chart for pistonrings: CUSUM")</code></p>
<p>and is shown in Figure .</p>
<p><img src="en_material_files/figure-html/unnamed-chunk-6-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="ewma-control-chart">EWMA control chart<a class="anchor" aria-label="anchor" href="#ewma-control-chart"></a>
</h4>
<p>The exponentially weighted moving average (EWMA) control chart was introduced by  as an alternative when we are interested in detecting small shifts. The performance of the EWMA control chart is approximately equivalent to that of the cumulative sum control chart since both monitor the process mean.</p>
<p>Both individual observations and rational sample means can be controlled by this type of chart, where moving averages <span class="math inline">\(y_i\)</span> are calculated by weighing the prior observations as follows</p>
<p><span class="math display">\[\begin{align*}
y_i=\lambda x_i+(1-\lambda)y_{i-1}
\end{align*}\]</span></p>
<p>with <span class="math inline">\(0&lt;\lambda&lt;1\)</span> and <span class="math inline">\(y_0 = \mu_0\)</span>, the target. Therefore, the EWMA control chart is performed by plotting <span class="math inline">\(y_i\)</span> versus the sample number <span class="math inline">\(i\)</span> (or time). The center line and control limits for the EWMA control chart are</p>
<p><span class="math display">\[\begin{align*}
\mbox{LCL} &amp; = \mu_0-3\sigma\sqrt{\frac{\lambda(1-(1-\lambda)^{2i})}{2-\lambda}}\\
\mbox{LCS} &amp; = \mu_0 \\
\mbox{UCL} &amp; = \mu_0+3\sigma\sqrt{\frac{\lambda(1-(1-\lambda)^{2i})}{2-\lambda}} 
\end{align*}\]</span></p>
<p>If the value of <span class="math inline">\(i\)</span> is high, then the control limits are:</p>
<p><span class="math display">\[\begin{align*}
\mbox{LCL} &amp; = \mu_0-3\sigma\sqrt{\frac{\lambda}{2-\lambda}}\\
\mbox{LCS} &amp; = \mu_0 \\
\mbox{UCL} &amp; =  \mu_0+3\sigma\sqrt{\frac{\lambda}{2-\lambda}}\\ 
\end{align*}\]</span></p>
<p>The EWMA control chart is plotted and its corresponding statistics are estimated by using the <code><a href="../reference/qcs.ewma.html">qcs.ewma()</a></code> function in the same manner as the CUSUM chart [see ].</p>
</div>
</div>
<div class="section level3">
<h3 id="example-of-applying-control-charts-to-control-the-mean">
<em>Example of applying control charts to control the mean</em><a class="anchor" aria-label="anchor" href="#example-of-applying-control-charts-to-control-the-mean"></a>
</h3>
<p>The methodology to control the central trend of a CTQ variable through the application of the Phase I and II control charts is shown in this section. The case study corresponding to the pistorings dataset, with piston diameter as CTQ variable, is used for this purpose.</p>
<div class="section level4">
<h4 id="stabilizing-the-process-and-estimating-the-natural-control-limits">Stabilizing the process and estimating the natural control limits<a class="anchor" aria-label="anchor" href="#stabilizing-the-process-and-estimating-the-natural-control-limits"></a>
</h4>
<p>The process to estimate the natural control limits is detailed in this section. The control limits can only be estimated in a proper way when the process is stabilized, i.e., in control. If the aim is to estimate the control limits of the piston diameter from the first forty rational samples (calibration sample) is intended, the Shewhart <span class="math inline">\(\bar{x}\)</span> control chart can be developed through the code:</p>
<p><code>R&gt; pistonrings.qcd &lt;- qcd(pistonrings)</code></p>
<p><code>R&gt; res.qcs &lt;- qcs.xbar(pistonrings.qcd)</code></p>
<p><code>R&gt; plot(res.qcs, title = "Xbar control chart for pistonrings I")</code></p>
<p>(see Figure ), and the results can be printed by calling</p>
<p><img src="en_material_files/figure-html/unnamed-chunk-7-1.png" width="60%" style="display: block; margin: auto;"></p>
<p><code>R&gt; summary(res.qcs)</code></p>
<pre><code><span class="co">#&gt; xbar chart for pistonrings </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Summary of group statistics:</span>
<span class="co">#&gt;       xbar      </span>
<span class="co">#&gt;  Min.   :73.99  </span>
<span class="co">#&gt;  1st Qu.:74.00  </span>
<span class="co">#&gt;  Median :74.00  </span>
<span class="co">#&gt;  Mean   :74.00  </span>
<span class="co">#&gt;  3rd Qu.:74.01  </span>
<span class="co">#&gt;  Max.   :74.02  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Group sample size:  5</span>
<span class="co">#&gt; Number of groups:  40</span>
<span class="co">#&gt; Center of group statistics:  74.0036</span>
<span class="co">#&gt; Standard deviation:  0.01007094 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Control limits: </span>
<span class="co">#&gt;       LCL      UCL</span>
<span class="co">#&gt;  73.99009 74.01712</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Beyond limits of control: </span>
<span class="co">#&gt; [1] 74.0196 74.0234</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Violationg runs: </span>
<span class="co">#&gt; [1] 74.0128</span></code></pre>
<p>(the sample range is used to estimate the variance by default). Figure  shows that two points are out of the control limits and another point is within the limits but corresponds to a run, therefore the process is out of control . The next step, once the assignable causes of these shifts are identified, is to remove the points that fall out the control limits (in red) and also the runs (in orange) and after recalculate the control limits until the process is in control. The <code>qcr</code> library includes the <code><a href="../reference/state.control.html">state.control()</a></code> function that removes the points indicative of out-of-control state and also returns a <code>qcd</code> object used to build a new control chart.</p>
<p><code>R&gt; res.qcd &lt;- state.control(res.qcs)</code></p>
<p><code>R&gt; res.qcs &lt;- qcs.xbar(res.qcd)</code></p>
<p><code>R&gt; plot(res.qcs, title = "Xbar control chart for pistonrings II")</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-9-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Figure  still shows a point outside the control limits. Therefore, the <code><a href="../reference/state.control.html">state.control()</a></code> function is used to delete it and the control limits are estimated again. Figure  shows that the process is under control, thus, the control limits estimates are reliable.</p>
<p><code>R&gt; res.qcd &lt;- state.control(res.qcs)</code></p>
<p><code>R&gt; res.qcs &lt;- qcs.xbar(res.qcd)</code></p>
<p><code>R&gt; plot(res.qcs, title = "Xbar control chart for pistonrings III")</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-10-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="monitoring-a-process">Monitoring a process<a class="anchor" aria-label="anchor" href="#monitoring-a-process"></a>
</h4>
<p>When the process is under control (Phase I) and once the control limits are calculated, the process is monitored (Phase II). In the next case, the first 25 subsamples (more than 20 are recommended) of piston diameter are used as calibration sample in order to estimate the control limits, whereas the remaining subsamples of pistonrings dataset form the monitoring sample. It is important to stress they are not taken into account in the natural control limits calculation [see ]. In Phase II, the hypothesis that each new observation belongs to the distribution of the CTQ variable estimated in Phase I is tested. Figure  shows the control limit estimation through the calibration sample. The process described by the diameter of pistons is in control. The corresponding code is:</p>
<p><code>R&gt; x &lt;- droplevels(pistonrings[1:125, ])</code></p>
<p><code>R&gt; y &lt;- droplevels(pistonrings[126:200, ])</code></p>
<p><code>R&gt; res.qcs &lt;- qcs.xbar(x, data.name = "Xbar control chart for pistonrings")</code></p>
<p><code>R&gt; plot(res.qcs)</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-11-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Once the control limits are obtained, the remaining samples are monitored (Figure ) by running</p>
<p><code>R&gt; res.qcs &lt;- qcs.add(x = res.qcs, value = y[, 1:2])</code></p>
<p><code>R&gt; plot(res.qcs)</code></p>
<p>As Figure  suggests, the process falls out of control from sample number thirty seven onwards, where the diameters are unusually high when compared with the calibration sample counterparts. These four points form a bunch pattern whose assignable cause should be identified before making any corrective actions or even recalculating the control limits due to an actual change in the process.</p>
<p><img src="en_material_files/figure-html/unnamed-chunk-12-1.png" width="60%" style="display: block; margin: auto;"></p>

</div>
<div class="section level4">
<h4 id="warning-limits">Warning limits<a class="anchor" aria-label="anchor" href="#warning-limits"></a>
</h4>
<p>Warning limits are applied during the Phase II when using the Shewhart control charts, in order to improve their performance against small shifts. They can be defined with a semi-amplitude of about <span class="math inline">\(2\sigma\)</span> as shown in Figure .</p>
<p><code>res.qcs &lt;- qcs.xbar(x, data.name = "Xbar control chart for pistonrings")</code></p>
<p><code>R&gt; plot(res.qcs, conf.nsigma.alert = 2)</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-13-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>However, the ARL is reduced when the process is actually in control. To prevent this drawback, CUSUM and EWMA control charts are excellent alternatives to the Shewhart control chart for detecting small changes (less than <span class="math inline">\(2\sigma\)</span>) during the Phase II of the process monitoring.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-statistical-quality-control">Multivariate statistical quality control<a class="anchor" aria-label="anchor" href="#multivariate-statistical-quality-control"></a>
</h2>
<p>When several random variables characterize the quality of a process/service, applying statistical multivariate quality control technique becomes necessary. In fact, if we analyze each variable separately, the probability that an observation of a variable will fall within the calculated limits when it is known that the process is actually under control, will no longer be 0.9973 for <span class="math inline">\(6\sigma\)</span> amplitude. Assuming independence, it will be <span class="math inline">\(0.9973^p\)</span>, where <span class="math inline">\(p\)</span> is the number of CTQ features, while the probability of type I will actually lead to <span class="math inline">\(\alpha'=1-(1-\alpha)^p\)</span>.</p>
<p>Therefore, the control limits are diferent from those drawn assuming the control of each CTQ variable independently from the others. Moreover, if the variables are dependent, the calculation of <span class="math inline">\(\alpha\)</span> becomes more complex. This subject is particularly important today, as automatic inspection procedures make it customary to measure many parameters of each product over time.</p>
<div class="section level3">
<h3 id="definition-of-multivariate-quality-control-objects-and-statistics">
<em>Definition of multivariate quality control objects and statistics</em><a class="anchor" aria-label="anchor" href="#definition-of-multivariate-quality-control-objects-and-statistics"></a>
</h3>
<p>In order to perform multivariate SQC, some some definitions are needed. Thus, suppose a random sample obtained from a multivariate normal distribution, <span class="math inline">\((\mbox{x}_1, \mbox{x}_2,\ldots, \mbox{x}_n)\)</span>, whereby the <span class="math inline">\(i\)</span>th component contains observations on each of the <span class="math inline">\(p\)</span> variables, <span class="math inline">\(x_{i1}, x_{i2},\ldots, x_{ip}\)</span>. Then, <em>the sample mean vector</em> is</p>
<p><span class="math display">\[\begin{align*}
\bar{\mbox{x}} &amp; =\frac{1}{n}\displaystyle\sum_{i=1}^{n}\mbox{x}_i=(\bar{x}_1,\bar{x}_2,\ldots,\bar{x}_p)
\end{align*}\]</span></p>
<p>and the <em>sample covariance matrix</em> is</p>
<p><span class="math display">\[\begin{align*}
S &amp; =\frac{1}{n-1}\displaystyle\sum_{i=1}^{n}(\mbox{x}_i-\bar{\mbox{x}})(\mbox{x}_i-\bar{\mbox{x}})^{\mbox{T}}
\end{align*}\]</span></p>
<p>with</p>
<p><span class="math display">\[\begin{align*}
s_{jk} &amp; =\frac{1}{n-1}\displaystyle\sum_{i=1}^{n}(x_{ij}-\bar{x}_j)(x_{ik}-\bar{x}_k)
\end{align*}\]</span></p>
<p>The sample mean vector and sample covariance matrix are unbiased estimators of the corresponding population parameters, i.e.,</p>
<p><span class="math display">\[\begin{align*}
E(\bar{\mbox{x}})=\mu=(\mu_1,\mu_2,\ldots,\mu_p)~~~~\mbox{and}~~~~E(S)=\Sigma
\end{align*}\]</span></p>
<p>This section uses the dowel1 dataset (composed of two CTQ variables, diameter and length of a dowel pin, that characterize its manufacturing process) available in the <code>MSQC</code> package. This data set is first transformed into an array by using the <code><a href="../reference/mqcd.html">mqcd()</a></code> function of the <code>qcr</code> library</p>
<p><code>R&gt; data("dowel1")</code></p>
<p><code>R&gt; data.mqcd &lt;- mqcd(dowel1)</code></p>
</div>
<div class="section level3">
<h3 id="statistical-control-using-the-t2-mcusum-and-mewma-charts">
<em>Statistical control using the T<span class="math inline">\(^2\)</span>, MCUSUM and MEWMA charts</em><a class="anchor" aria-label="anchor" href="#statistical-control-using-the-t2-mcusum-and-mewma-charts"></a>
</h3>
<div class="section level4">
<h4 id="hotelling-t2-control-chart">Hotelling T<span class="math inline">\(^2\)</span> control chart<a class="anchor" aria-label="anchor" href="#hotelling-t2-control-chart"></a>
</h4>
<p>The Hotelling T<span class="math inline">\(^2\)</span> control chart is the most popular tool devoted to control the quality of processes and services from more than one CTQ variable. Consider a control process in which <span class="math inline">\(p\)</span> variables are observed and distributed according to <span class="math inline">\(p\)</span>-variant normal distribution <span class="math inline">\(\mathcal{N}p(\mu_0, \Sigma_0)\)</span> with a vector of means <span class="math inline">\(\mu_0 = (\mu_{01}, \mu_{02},\ldots,\mu_{0p})\)</span> and a variance-covariance matrix <span class="math inline">\(\Sigma_0\)</span> of order <span class="math inline">\(p\)</span>. We want to test the hypothesis: <span class="math inline">\(H_0 : \mu_i = \mu_0, \forall i~~ \mbox{vs} ~~H_1 : \exists\mu_j \neq \mu_0\)</span>, to determine if the process is under control. For this purpose, diferent criteria have been developed, highlighting the T<span class="math inline">\(^2\)</span> Hotelling statistic, defined as</p>
<p><span class="math display">\[\begin{align*}
T_{i}^{2}=n(\bar{\mbox{x}}_i-\mu_0)^{\mbox{T}}\Sigma_{0}^{-1}(\bar{\mbox{x}}_i-\mu_0)
\end{align*}\]</span></p>
<p>whereby <span class="math inline">\(\bar{\mbox{x}}_i=(\bar{x}_{i1},\bar{x}_{i2},\ldots,\bar{x}_{ip})\)</span> is the vector of means for the <span class="math inline">\(p\)</span> characteristics in the <span class="math inline">\(i\)</span>th subsample. When the subgroup size is one, vectors of observations will be obtained instead of vectors of means. When the process is under control (<span class="math inline">\(\mu_i=\mu_0\)</span>), there is a probability <span class="math inline">\(\alpha\)</span>, that the <span class="math inline">\(T^2_i\)</span> statistic exceeds the critical value <span class="math inline">\(\chi_{p,\alpha}^2\)</span>. Therefore, a value of the <span class="math inline">\(T^2_i\)</span> statistic exceeding the <span class="math inline">\(\chi_{p,\alpha}^2\)</span> value is taken as an out of control signal.</p>
<p>From a geometric point of view, the <span class="math inline">\(T^2\)</span> statistic is the ratio of the squared distance (Mahalanobis) between a multivariate observation and the vector of target values (vector of means), where equidistant points form ellipsoids around that vector of means. The greater the value of <span class="math inline">\(T^2\)</span>, the greater the distance between the observation and the target value.</p>
<p>If <span class="math inline">\(\mu_0\)</span> and <span class="math inline">\(\Sigma_0\)</span> are known and the process is under control, the <span class="math inline">\(T^2_i\)</span> statistic is distributed as a central chi-squared with p degrees of freedom (<span class="math inline">\(T^2_i\sim\chi_{p}^2\)</span> ). When the process is out-of-control, the statistic is distributed as a non central chi-squared with <span class="math inline">\(p\)</span> degrees of freedom and non-centrality parameter <span class="math inline">\(\lambda=n(\mu_1-\mu_0)^{\mbox{T}}\Sigma_{0}^{-1}(\mu_1-\mu_0)\)</span>, where <span class="math inline">\(\mu_1\)</span> is the mean vector of the <span class="math inline">\(p\)</span> characteristics when there is a change in at least one of the <span class="math inline">\(d\)</span> means.</p>
<p>In practice, the value of the <span class="math inline">\(T^2\)</span> statistic is estimated by the corresponding sample values through the expression</p>
<p><span class="math display">\[\begin{align*}
T^{2}=n(\bar{\mbox{x}}-\bar{\bar{\mbox{x}}})^{\mbox{T}}\Sigma^{-1}(\bar{\mbox{x}}-\bar{\bar{\mbox{x}}})
\end{align*}\]</span></p>
<p>whose distribution under the null hypothesis is</p>
<p><span class="math display">\[\begin{align*}
T^{2}\sim\frac{p(m-1)(n-1)}{mn-m-p+1}F_{p,mn-m-p + 1}
\end{align*}\]</span></p>
<p>Namely, in this case, the statistic follows approximately a <span class="math inline">\(F\)</span> distribution with <span class="math inline">\(p\)</span> and <span class="math inline">\((mn-m-p + 1)\)</span> degrees of freedom. Since both the <span class="math inline">\(\chi^2\)</span> and <span class="math inline">\(F\)</span> distributions are asymmetrical with right skewness, only the expression for the upper control limit is considered, which is given by</p>
<p><span class="math display">\[\begin{align*}
\mbox{UCL}=\frac{p(m-1)(n-1)}{mn-m-p+1}F_{\alpha,p,mn-m-p + 1}
\end{align*}\]</span></p>
<p>and LCL = 0 is considered for the lower control limit. In addition, for processes in which <span class="math inline">\(m\)</span> is suficiently large (<span class="math inline">\(m &gt; 100\)</span>), this limit can be approximated by <span class="math inline">\(\mbox{UCL} =\chi_{\alpha,p}^2\)</span>.</p>
<p> recommend using these limits in a first phase, which is called a retrospective analysis. Once the control limit is estimated, a second control limit is estimated in the Phase II of process monitoring. Hence, a consistent change consisting on the multiplication of the UCL by <span class="math inline">\(\frac{m+1}{m-1}\)</span>, thus obtaining a new value for the upper control limit.</p>
<p>In the case of individual observations, i.e., <span class="math inline">\(n = 1\)</span>, and assuming that we have overall <span class="math inline">\(m\)</span> subsamples to evaluate <span class="math inline">\(p\)</span> control variables, the corresponding control chart is developed from the following control limits</p>
<p><span class="math display">\[\begin{align*}
\mbox{UCL}&amp;=\frac{p(m+1)(n-1)}{m^2-mp}F_{\alpha,p,m-p}\\
\mbox{LCL}&amp;= 0
\end{align*}\]</span></p>
<p>The <code><a href="../reference/mqcs.t2.html">mqcs.t2()</a></code> function can used to compute statistics required by the <span class="math inline">\(T^2\)</span> chart.</p>
<p><code>R&gt; res.mqcs &lt;- mqcs.t2(data.mqcd)</code></p>
<p><code>R&gt; plot(res.mqcs, title = "Hotelling control chart for dowel pin")</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-14-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>As shown in Figure , the control limits have been estimated observing that the Dowell pins process is under control. The next step should be to implement the Phase II process monitoring using the proper UCL. The UCL for retrospective analysis or for monitoring phase can be computed by setting the phase argument to 1 or 2, respectively, of the <code><a href="../reference/mqcs.t2.html">mqcs.t2()</a></code> function.</p>
</div>
<div class="section level4">
<h4 id="mcusum-control-charts">MCUSUM control charts<a class="anchor" aria-label="anchor" href="#mcusum-control-charts"></a>
</h4>
<p>Woodall and Ncube  proposed a scheme based on multiple univariate CUSUM control charts. This method is often preferable to Hotelling’s <span class="math inline">\(T^2\)</span> procedure for controlling those processes defined by Gaussian bivariate CTQ variables, as it also happened in the univariate approach when identifying small shifts from the mean is intended.</p>
<p>Healy  developed the following multivariate CUSUM model:</p>
<p><span class="math display">\[\begin{align*}
G_i=\mbox{max}\{(G_{i-1}+a^T(\bar{\mbox{x}}_i-\mu_0)-0,5D),0\}
\end{align*}\]</span></p>
<p>whereby</p>
<ul>
<li><p><strong><span class="math inline">\(\mu_0\)</span></strong> is the mean vector when the process is under control,</p></li>
<li><p><strong><span class="math inline">\(\Sigma_0\)</span></strong> is variance-covariance matrix when process is under control,</p></li>
<li><p><strong><span class="math inline">\(\mu_1\)</span></strong> acounts for the mean vector when the process is out-of-control,</p></li>
<li><p><strong><span class="math inline">\(D=\sqrt{(\mu_1-\mu_0)^{\mbox{T}}\Sigma_{0}^{-1}(\mu_1-\mu_0)}\)</span></strong> is a noncentrality parameter,</p></li>
<li><p><strong><span class="math inline">\(a^T=\frac{A}{D}\)</span></strong> with <span class="math inline">\(A=(\mu_1-\mu_0)^{\mbox{T}}\Sigma_{0}^{-1}\)</span></p></li>
</ul>
<p>In order to interpret the chart, an alarm signal is produced when <span class="math inline">\(G_i\)</span> exceeds a certain reference value <span class="math inline">\(H\)</span>, conveniently chosen and tabulated. Hawkins  developed a model for variables adjusted by multivariate regression, based on the assumption that when a change occurs in the mean, it is due to a magnitude variation in the mean of one of the variables of the multivariate dataset. Other proposed MCUSUM charts are those of Crosier  and Pignatiello and Runger . The Croiser procedure has been implemented in the qcr package. This method reduces each multivariate observation to a scalar from which the CUSUM statistic is finally developed using the following expression: <span class="math display">\[\begin{align*}
S_i=\mbox{max}\{0,S_{i.1}+T_i-k\}
\end{align*}\]</span></p>
<p>where <span class="math inline">\(T_i=\sqrt{n(\bar{\mbox{x}}_i-\mu_0)^{\mbox{T}}\Sigma_{0}^{-1}(\bar{\mbox{x}}_i-\mu_0)}\)</span>, and <span class="math inline">\(S_0\geq 0\)</span> (generally <span class="math inline">\(S_0 = 0\)</span>) and <span class="math inline">\(k &gt; 0\)</span>. The MCUSUM chart gives an out of control signal when the value of <span class="math inline">\(S_i\)</span> is greater than a certain value <span class="math inline">\(h\)</span> which depends on the value of the desired ARL when the process is operating at the target value [<span class="math inline">\(S_i &gt; h\)</span>]. Crosier used Markov processes for determining the values of <span class="math inline">\(h\)</span> and <span class="math inline">\(k\)</span> with <span class="math inline">\(p=2,5,10\)</span> and 20 and ARL values of 200 and 500 (with process is under control). These tables were designed to detect a change <span class="math inline">\(d = 1\)</span> in the mean vector, where <span class="math inline">\(d = \lambda\)</span>, with <span class="math inline">\(\lambda\)</span> a non-centrality parameter. The <code><a href="../reference/mqcs.mcusum.html">mqcs.mcusum()</a></code> function of <code>qcr</code> package is used to compute the statistics required to perform the MCUSUM chart</p>
<p><code>R&gt; res.mqcs &lt;- mqcs.mcusum(data.mqcd)</code></p>
<p><code>R&gt; plot(res.mqcs, title = "MCUSUM control chart for dowel pin")</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-15-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="mewma-control-charts">MEWMA control charts<a class="anchor" aria-label="anchor" href="#mewma-control-charts"></a>
</h4>
<p>The exponentially weighted moving average chart for the multivariate case (MEWMA) is an extension of the corresponding univariate chart. The multivariate extension, proposed by Lowry <em>et al</em>. , is defined as</p>
<p><span class="math display">\[\begin{align*}
Z_i=\Lambda\bar{\mbox{x}}_i+(I-\Lambda)Z_{i-1}
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\bar{\mbox{x}}_i\)</span> is the mean vector and <span class="math inline">\(\Lambda = diag (\lambda_1,\ldots,\lambda_p)\)</span>, where <span class="math inline">\(\lambda_j\)</span> accounts for the “depth” of memory for each variable, i.e., weights the importance of the previous observations for calculating each moving average. The higher the value of <span class="math inline">\(\lambda_j\)</span> , the lower the depth and the importance of past observations. Further, <span class="math inline">\(I\)</span> is the identity matrix and <span class="math inline">\(Z_0 = 0\)</span> is considered as initial value.</p>
<p>The information provided by the <span class="math inline">\(Z_i\)</span> is collected in the statistic</p>
<p><span class="math display">\[\begin{align*}
T_i^2=Z_i^T\Sigma_{Z_i}^{-1}Z_{i}
\end{align*}\]</span></p>
<p>Whereby <span class="math inline">\(\Sigma_{Z_i}^{-1}\)</span> is the inverse of the variance-covariance matrix of the <span class="math inline">\(Z_i\)</span>.</p>
<p>The control output signal occurs when <span class="math inline">\(T^2_i\)</span> exceeds a certain value <span class="math inline">\(h &gt; 0\)</span>, selected in order to achieve a certain ARL value when the process is in control. Usually, if there is no prior reason for weighting with diferent weights the previous observations of each one of the <span class="math inline">\(p\)</span> variables, <span class="math inline">\(\lambda_1 = \ldots = \lambda_p\)</span> is assumed. The <span class="math inline">\(Z_i\)</span> matrix can be obtained from the elements of the variance-covariance matrix corresponding to the variables analyzed by the expression <span class="math display">\[\begin{align*}
\Sigma_{Z_i}=\frac{\lambda}{2-\lambda}\left[1-(1-\lambda)^{2i}\right]\Sigma_x
\end{align*}\]</span> where <span class="math inline">\(\Sigma_x\)</span> is the original variance-covariance matrix.</p>
<p>When <span class="math inline">\(r = 1\)</span>, the MEWMA chart matches the <span class="math inline">\(T^2\)</span> control chart since the asymptotic value of the variance-covariance matrix of <span class="math inline">\(Z_i\)</span> is <span class="math display">\[\begin{align*}
\Sigma_{Z_i}=\frac{\lambda}{2-\lambda}\Sigma_x
\end{align*}\]</span> Regarding the choice of the upper control limit, Runger and Prabhu  suggest a Markov chain approximation, which allows us to study the performance of the chart taking into account the ARL. They also provide a series of recommendations for selecting the parameters of the proposed control chart. Moreover, Montgomery  recommends the <span class="math inline">\(\lambda\)</span> parameter value to be between 0.05 and 0.25. The higher the value of the parameter, the less importance will be given to values that are further away in time. Taking into account ARL based criteria, <span class="math inline">\(\lambda = 0.1\)</span> is usually chosen in practical applications. This is the default value when the <code>qcr</code> <code><a href="../reference/mqcs.mewma.html">mqcs.mewma()</a></code> function is used to compute statistics required by the MEWMA chart.</p>
<p><code>R&gt; res.mqcs &lt;- mqcs.mewma(data.mqcd)</code></p>
<p><code>R&gt; plot(res.mqcs, title = "MEWMA control chart for dowel pin")</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-16-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>See the package documentation  for more information about the arguments of this function. As in the previous cases, after the estimation of the corresponding control limits, the MEWMA control chart shown in Figure  indicates that the process is under control.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="nonparametric-control-charts-based-on-data-depth">Nonparametric control charts based on data depth<a class="anchor" aria-label="anchor" href="#nonparametric-control-charts-based-on-data-depth"></a>
</h2>
<p>The control charts presented in this section were proposed by  as an alternative to those described in previous section. The main idea of its control graphs is to reduce each multivariate measure to a univariate index, that is, its relative center-exterior classification induced by a depth of data. This approach is completely nonparametric, therefore, these control charts are not defined by any parametric assumption regarding the process model. Thus, they are applicable in a wider number of case studies than those counterparts such as <span class="math inline">\(T^2\)</span>, MSUSUM and MEWMA control charts. In addition, these graphs allow the simultaneous detection of the change of location (shift of the mean) and the increase of the scale (change in variability) in a process.</p>
<p>Liu proposed and justified three types of control charts, the <span class="math inline">\(r\)</span>, <span class="math inline">\(Q\)</span>, and <span class="math inline">\(S\)</span> charts which can be considered as data-depth-based multivariate generalizations of the univariate <span class="math inline">\(X\)</span>, <span class="math inline">\(\bar{x}\)</span>, and CUSUM charts, respectively.</p>
<div class="section level3">
<h3 id="data-depth">
<em>Data depth</em><a class="anchor" aria-label="anchor" href="#data-depth"></a>
</h3>
<p>In multivariate analysis, the term depth refers to the degree of centrality of a point regarding to a data cloud or a probability distribution. Therefore, it is possible to define a rank in the multidimensional Euclidean space through the calculation of observation depth. According to  and Cascos <em>et al</em>. , the depth function can be defined as a bounded function <span class="math inline">\(D_p:R^d\longrightarrow R\)</span>, with <span class="math inline">\(P\)</span> the distribution set in <span class="math inline">\(R^d\)</span>, that assigns at each point of <span class="math inline">\(R^d\)</span> its degree of centrality with respect to <span class="math inline">\(P\)</span>. Depth functions with which control charts can be performed are the</p>
<ul>
<li><p>Simplicial depth (Liu <em>et al</em>. ),</p></li>
<li><p>Mahalanobis depth (Mahalanobis \cite(b35)),</p></li>
<li><p>Halfspace or Tukey depth (Tukey ),</p></li>
<li><p>Likelihood depth (Fraiman <em>et al</em>. ), and</p></li>
<li><p>Random projection depth (Zuo and Sering ).</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="statistics-derived-from-data-depth">
<em>Statistics derived from data depth</em><a class="anchor" aria-label="anchor" href="#statistics-derived-from-data-depth"></a>
</h3>
<p>Let <span class="math inline">\(G\)</span> a <span class="math inline">\(k\)</span>-dimensional distribution, and let <span class="math inline">\(Y_1,\ldots,Y_m\)</span> be <span class="math inline">\(m\)</span> random observations from <span class="math inline">\(G\)</span>. The sample <span class="math inline">\(Y_1,\ldots,Y_m\)</span> is generally the reference sample of a CTQ variable in the context of quality control, composed of measurements from products obtained by an under control process. If <span class="math inline">\(X_1,X_2, \ldots\)</span> are the new observations from the manufacturing process, assuming that the diferent <span class="math inline">\(X_i\)</span> values follow an <span class="math inline">\(F\)</span> distribution if the quality of the studied product has been deteriorated or, in other words, if the process is out of control. Otherwise they follow a <span class="math inline">\(G\)</span> distribution. Let <span class="math inline">\(D_{G}(·)\)</span> denote a notion of depth, and assume that <span class="math inline">\(G\)</span> and <span class="math inline">\(F\)</span> are two continuous distributions. Thus, if all the <span class="math inline">\(D_G(Yi)\)</span> values are sorted in increasing order, and <span class="math inline">\(Y_{[j]}\)</span> denotes the sample value associated with the <span class="math inline">\(j\)</span>th smallest depth value, then <span class="math inline">\(Y_{[1]},\ldots,Y_{[m]}\)</span> are the order statistics of <span class="math inline">\(Y_i's\)</span>, with <span class="math inline">\(Y_{[m]}\)</span> being the most central point. Therefore, the smaller the order (or the rank) of a point, the farther that point will be from the underlying distribution <span class="math inline">\(G(\cdot)\)</span>.</p>
<p>Liu  defines the rank statistic as <span class="math display">\[\begin{align*}
r_G(y)=P\{D_G(Y) \leq D_G(y)|Y \sim G \}
\end{align*}\]</span> whereby <span class="math inline">\(Y\sim G\)</span> indicates that the random variable <span class="math inline">\(Y\)</span> follows the distribution <span class="math inline">\(G\)</span>. When <span class="math inline">\(G\)</span> is unknown, the empirical distribution <span class="math inline">\(G_m\)</span> of the sample <span class="math inline">\(\{Y_1,\ldots, Y_m\}\)</span> can be used instead, and the statistic is defined by <span class="math display">\[\begin{align*}
r_{G_m}(y)=\frac{\#\{D_{G_m}(Y_j)\leq D_{G_m}(y), j=1,\ldots,m\}}{m}
\end{align*}\]</span> In the same way that <span class="math inline">\(r_G\)</span> and <span class="math inline">\(r_{G_m}\)</span>, the <span class="math inline">\(Q\)</span> statistics can be also defined as follows <span class="math display">\[\begin{align*}
Q(G,F)=P\{D_G(Y)\leq D_G(X)| Y\sim G, X\sim F\}=E_F[r_G(X)] 
\end{align*}\]</span> <span class="math display">\[\begin{align*}
Q(G,F_n)&amp;=\frac{1}{n}\displaystyle\sum_{i=1}^{n}r_G(X_i)\\
Q(G_m,F_n)&amp;=\frac{1}{n}\displaystyle\sum_{i=1}^{n}r_{G_m}(X_i)
\end{align*}\]</span></p>
<p>whereby <span class="math inline">\(F_n(·)\)</span> denotes the empirical distribution of the sample <span class="math inline">\(\{X_1,\ldots,X_n\}\)</span>. The control charts corresponding to these statistics can be developed as described in the following sections.</p>
</div>
<div class="section level3">
<h3 id="the-r-chart">
<em>The <code>r</code> chart</em><a class="anchor" aria-label="anchor" href="#the-r-chart"></a>
</h3>
<p>Calculate <span class="math inline">\(\{r_G(X1),r_G(X2),\ldots,r_G (Xn)\}\)</span> or <span class="math inline">\(\{r_{G_m}(X1), r_{G_m}(X2),\ldots,r_{G_m}(Xn)\}\)</span> if <span class="math inline">\(G\)</span> is unknow but <span class="math inline">\(Y_1,\ldots Y_m\)</span> are available. As a result, the <span class="math inline">\(r\)</span> chart consists of plotting the rank statistic in regard to time. The control chart central line is CL = 0.5, whereas the lower limit is LCL =<span class="math inline">\(\alpha\)</span>, with <span class="math inline">\(alpha\)</span> accounting for the false alarm rate. The process will be out of control if <span class="math inline">\(r_G(\cdot)\)</span> falls under LCL. A small value of the rank statistic <span class="math inline">\(r_{G_m}(X)\)</span> means that only a very small proportion of <span class="math inline">\(Y_i\)</span> values are more outlying than <span class="math inline">\(X\)</span>. Therefore, assuming that <span class="math inline">\(X\sim F\)</span>, then a small value of <span class="math inline">\(r_{G_m}(X)\)</span> suggests a possible deviation from <span class="math inline">\(G\)</span> to <span class="math inline">\(F\)</span>. This may be due to a shifting in the location and/or an increase in the scale of the studied CTQ variable. Taking into account that the UCL is not defined for the <span class="math inline">\(r\)</span> chart, the CL line serves as a reference to identify emerging patterns, runs or trends. If <span class="math inline">\(r_{G_m}(X)\)</span> is greater than 0.5, there is an evidence of scale decreasing, and also could take place a negligible location shift. This case should be tackled as an improvement in quality given a gain in accuracy, and thus the process should not considered as out of control.</p>
</div>
<div class="section level3">
<h3 id="the-q-chart">
<em>The Q chart</em><a class="anchor" aria-label="anchor" href="#the-q-chart"></a>
</h3>
<p>The idea behind the <span class="math inline">\(Q\)</span> chart is similar to the one behind the <span class="math inline">\(\bar{x}\)</span> chart. If <span class="math inline">\(X_1,X_2,\ldots\)</span> are univariate and <span class="math inline">\(G\)</span> is a normal distribution, the <span class="math inline">\(\bar{x}\)</span> chart plots the averages of consecutive subsets of the de diferent <span class="math inline">\(X_i\)</span>. A goal of this type of chart is that it can prevent the identification of false alarm when the process is actually in control (even when some individual sample points fall out of control limits due to random fuctuations).</p>
<p>The <span class="math inline">\(Q\)</span> chart is the nonparametric alternative to <span class="math inline">\(\bar{x}\)</span> chart. It is performed by plotting the averages of consecutive subsets of size <span class="math inline">\(n\)</span> corresponding to the rank statistic (<span class="math inline">\(r_G(Xi)\)</span> or <span class="math inline">\(r_{G_m}(Xi)\)</span>), given by <span class="math inline">\(Q\left(G,F_n^j\right)\)</span> or <span class="math inline">\(Q\left(Gm,F_n^j\right)\)</span> whereas <span class="math inline">\(F_n^j\)</span> is the empirical distribution of the <span class="math inline">\(X_i's\)</span> in the <span class="math inline">\(j\)</span>th subset, <span class="math inline">\(j = 1, 2,\ldots\)</span>. Accordingly, if only <span class="math inline">\(\{Y_1,Y_2,\ldots,Y_m\}\)</span> are available, the <span class="math inline">\(Q\)</span> chart plots the sequence <span class="math inline">\(\{Q\left(G_m,F_n^j\right), Q\left(G_m,F_n^j\right),\ldots \}\)</span>.</p>
<p>Depending on the value of <span class="math inline">\(n\)</span>, the corresponding control limits are as follows</p>
<ul>
<li>If <span class="math inline">\(n&gt;5\)</span>, CL=0.5 and
<ul>
<li>LCL=<span class="math inline">\(0.5-Z_\alpha(12n)^\frac{1}{2}~~~~\mbox{for}~~~~Q\left(G,F_n^j\right)\)</span>
</li>
<li>LCL= <span class="math inline">\(0.5-Z_{\alpha}\sqrt{\frac{1}{12}\left(\frac{1}{m}+\frac{1}{n}\right)}~~~~\mbox{for}~~~~Q\left(Gm,F_n^j\right)\)</span>
</li>
</ul>
</li>
<li>If <span class="math inline">\(n&lt;5\)</span>, CL=0.5 and LCL=<span class="math inline">\(\frac{(n!\alpha)^{\frac{1}{2}}}{n}\)</span>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="the-s-control-chart">
<em>The S control chart</em><a class="anchor" aria-label="anchor" href="#the-s-control-chart"></a>
</h3>
<p>The <span class="math inline">\(S\)</span> control chart is based on the CUSUM univariate control chart, which is basically the plot of <span class="math inline">\(\displaystyle\sum_{i=1}^n(X-\mu)\)</span> which refects the pattern of the total deviation from the expected value. As mentioned above, it is more efective than the <span class="math inline">\(X\)</span> chart or the <span class="math inline">\(\bar{x}\)</span> chart in detecting small process changes. The nonparametric CUSUM chart based on data depth suggests plotting <span class="math inline">\(S_n(G)\)</span> and <span class="math inline">\(S_n(G_m)\)</span>, defined by <span class="math display">\[\begin{align*}
S_n(G)=\displaystyle\sum_{i=1}^n\left(r_G(X_i)-\frac{1}{2}\right)
\end{align*}\]</span> with control limits CL = 0 and LCL = <span class="math inline">\(-Z_{\alpha}\left(\frac{n}{12}\right)^{\frac{1}{2}}\)</span>, and <span class="math display">\[\begin{align*}
S_n(G_m)=\displaystyle\sum_{i=1}^n\left(r_{G_m}(X_i)-\frac{1}{2}\right)
\end{align*}\]</span> And, if only <span class="math inline">\(Y_1,\ldots,Y_m\)</span> are available, the control limits are CL = 0 and LCL = <span class="math inline">\(-Z_{\alpha}\sqrt{n^2\frac{\left(\frac{1}{m}+\frac{1}{n}\right)}{12}}\)</span>. The LCL control limits in both cases constitute a curve instead of a straight line; if <span class="math inline">\(n\)</span> is large, the control chart <span class="math inline">\(S\)</span> should be standardized as follows <span class="math display">\[\begin{align*}
S_{n}^{*}(G)&amp;=\frac{S_n(G)}{\sqrt{\frac{n}{12}}}\\
S_{n}^{*}(G_m)&amp;=\frac{S_n(G_m)}{\sqrt{n^2\frac{\left(\frac{1}{m}+\frac{1}{n}\right)}{12}}}
\end{align*}\]</span> Therefore, this <span class="math inline">\(S^*\)</span> chart is defined by CL = 0 and LCL = <span class="math inline">\(-Z_{\alpha}\)</span>.</p>
</div>
<div class="section level3">
<h3 id="examples-of-r-q-and-s-control-charts-applied-using-synthetic-data">
<em>Examples of r, Q and S control charts applied using synthetic data</em><a class="anchor" aria-label="anchor" href="#examples-of-r-q-and-s-control-charts-applied-using-synthetic-data"></a>
</h3>
<p>A bivariate data set is used to illustrate how the previously discussed control charts arise. In fact, a synthetic dataset composed of 540 observations of a bidimensional standard Gaussian variable has been simulated, in addition to 40 individuals corresponding to another bidimensional Gaussian variable with mean and standard deviation equal to 2.</p>
<p><code>R&gt; mu &lt;- c(0, 0)</code></p>
<p><code>R&gt; Sigma &lt;- matrix(c(1, 0, 0, 1), nrow = 2)</code></p>
<p><code>R&gt; Y &lt;- rmvnorm(540, mean = mu, sigma = Sigma)</code></p>
<p><code>R&gt; u &lt;- c(2, 2)</code></p>
<p><code>R&gt; S &lt;- matrix(c(4, 0, 0, 4), nrow = 2)</code></p>
<p><code>R&gt; x &lt;- rmvnorm(40, mean = u, sigma = S)</code></p>
<p>Prior to the application of nonparametric control charts, the dataset has to be converted into a <code>npqcsd</code> object. The synthetic dataset is arranged as two matrices, <code>G</code> composed of the 500 first rows (multivariate observations) of <code>Y</code>, and <code>x</code> with the remaining ones and including those belonging to the second bidimensional variable</p>
<p><code>R&gt; x &lt;- rbind(Y[501:540, ], x)</code></p>
<p><code>R&gt; G &lt;- Y[1:500, ]</code></p>
<p><code>R&gt; data.npqcd &lt;- npqcd(x, G)</code></p>
<p>In the same way the <code>npqcd</code> function creates a data object for non parametric quality control, the <code><a href="../reference/npqcs.r.html">npqcs.r()</a></code>, <code><a href="../reference/npqcs.Q.html">npqcs.Q()</a></code> and <code><a href="../reference/npqcs.S.html">npqcs.S()</a></code> functions computes all the statistics required to obtain the <span class="math inline">\(r, Q\)</span> and <span class="math inline">\(S\)</span> control charts, respectively. The argument <code>method = c("Tukey", "Liu", "Mahalanobis", "RP", "LD")</code> specify the data detph function and alpha is the signification level that defines the LCL. See  to obtain additional information about these functions and their arguments.</p>
<div class="section level4">
<h4 id="r-chart">
<span class="math inline">\(r\)</span> chart<a class="anchor" aria-label="anchor" href="#r-chart"></a>
</h4>
<p>The <span class="math inline">\(r\)</span> control chart can be obtained by applying the <code><a href="../reference/npqcs.r.html">npqcs.r()</a></code> function to the <code>npqcd</code> object and plotting the result</p>
<p><code>R&gt; res.npqcs &lt;- npqcs.r(data.npqcd, method = "Tukey", alpha = 0.025)</code></p>
<p><code>R&gt; plot(res.npqcs, title = " r Control Chart")</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-17-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>The resulting chart is shown in Figure , where it can be observed that the process is out of control from the 42nd observation, as expected, taking into account that most of the <span class="math inline">\(r_{G_m}(X_i)\)</span> values are falling below the LCL.</p>
</div>
<div class="section level4">
<h4 id="q-chart">
<span class="math inline">\(Q\)</span> chart<a class="anchor" aria-label="anchor" href="#q-chart"></a>
</h4>
<p>In this case, the dataset is assumed to be composed of rational samples of size 4, thus, the <span class="math inline">\(Q\)</span> nonparametric alternative of <span class="math inline">\(bar{x}\)</span> chart is proposed and applied to control the bidimensional process</p>
<p><code>R&gt; n &lt;- 4 # samples</code></p>
<p><code>R&gt; m &lt;- 20 # measurements</code></p>
<p><code>R&gt; k &lt;- 2 # number of variables</code></p>
<p><code>R&gt; x.a &lt;- array( , dim = c(n, k, m))</code></p>
<p><code>R&gt; for (i in 1:m) {</code> <code>x.a[, , i] &lt;- x[(1 + (i - 1) * n):(i * n), ]}</code></p>
<p><code>R&gt; data.npqcd &lt;- npqcd(x.a, G)</code></p>
<p><code>R&gt; res.npqcs &lt;- npqcs.Q(data.npqcd, method = "Tukey", alpha = 0.025)</code></p>
<p><code>R&gt; plot(res.npqcs, title = "Q Control Chart")</code></p>
<p>Figure  clearly shows that the process is out of control in the second half, from the 20th rotational sample. We can also see that the high random fuctuations of the <span class="math inline">\(r\)</span> chart are attenuated in the <span class="math inline">\(Q\)</span> chart due to the averaging effect.</p>
<p><img src="en_material_files/figure-html/unnamed-chunk-18-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="s-chart">
<span class="math inline">\(S\)</span> chart<a class="anchor" aria-label="anchor" href="#s-chart"></a>
</h4>
<p>Finally, the nonparametric counterpart of CUSUM control chart is performed from the multivariate individual observations</p>
<p><code>R&gt; data.npqcd &lt;- npqcd(x, G)</code></p>
<p><code>R&gt; res.npqcs &lt;- npqcs.S(data.npqcd, method = "Tukey", alpha = 0.05)</code></p>
<p><code>R&gt; plot(res.npqcs, title = "S Control Chart")</code></p>
<p>Figure  shows that the process is out of control from the 48th observation. Note that the <span class="math inline">\(S\)</span> graph performs better in identifying small changes in a process. In this case, he performance of <span class="math inline">\(Q\)</span> chart is better than the corresponding to the <span class="math inline">\(S\)</span> chart.</p>
<p><img src="en_material_files/figure-html/unnamed-chunk-19-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="process-capability-analysis">Process capability analysis<a class="anchor" aria-label="anchor" href="#process-capability-analysis"></a>
</h2>
<p>The analysis of the capability of a process in the case of statistical quality control is done through the calculation of the so called capability. These indices measure whether a process is capable or not of meeting the corresponding technical specifications set by the customer, or the manufacturer, by comparing those with the natural variability of the CTQ variable that characterizes the process. The interpretation of these indices is associated with the result of this relation. Capability indices are generally calculated as the ratio between the length of the specification interval and the natural variability of the process in terms of <span class="math inline">\(\sigma\)</span>. Large values of these indices mean that the corresponding process is capable of producing articles that meet the requirements of the client, and manufacturers. In other words, the larger the value of the capability index, the smaller the number of products outside the specification limits.</p>
<p>In this section, we describe the capability indices for processes whose underlying distribution is normal and not normal (exponential, Weibull, etc.). However, it is important to note that the development of programming tools for nonparametric capability analysis is one of the main goals and contributions of the <code>qcr</code> package. In addition to the estimation of capability indices, a graphical output is provided. Based on the proposal of <code>qualityTools</code> package, the <code>qcr</code> graphical output for capability analysis includes a normality test for the CTQ variable, a Q-Q plot, a histogram with the theoretical Gaussian distribution density, parametric and nonparametric estimates of capability indices and a contour capability control chart. In the following lines, parametric and nonparametric capability analysis utilities are described using different examples of application.</p>
<div class="section level3">
<h3 id="assuming-a-normal-distribution">Assuming a normal distribution<a class="anchor" aria-label="anchor" href="#assuming-a-normal-distribution"></a>
</h3>
<p>The most widely used capability indexes in the industry analyze the process capability under the assumptions of stabilized process (in control) and a Gaussian distributed CTQ variable. Table  shows the main parametric (assuming Gaussian distribution) indices, namely <span class="math inline">\(C_p, C_{pk}, C_{pm},~~\mbox{and}~~C_{pmk}\)</span>.</p>
<p>Vännman  proposed a general formulation of these indices by an expression that depends on the non-negative parameters <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>: <span class="math display">\[\begin{align*}
C_p(u,v)=\frac{d-u|\mu-m|}{3\sqrt{\sigma^2+v(u+T)^2}}
\end{align*}\]</span> Whereby <span class="math inline">\(d = \frac{(USL-LSL)}{2}\)</span>, <span class="math inline">\(m = \frac{(LSL + USL)}{2}\)</span>, USL is the upper specification limit, the LSL is the lower specification limit, <span class="math inline">\(\sigma\)</span> is the theoretical standard deviation, <span class="math inline">\(\mu\)</span> accounts for the theoretical mean of the CTQ variable, and <span class="math inline">\(T\)</span> is the specification target (by default the mean between the LSL and USL). The indices shown in Table  are obtained from this expression just considering values of 0 or 1 for <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>: <span class="math inline">\(C_p (0, 0) = C_p, C_p (1, 0) = C_{pk}, C_p (0, 1) = C_{pm}, C_p (1, 1) = C_{pmk}\)</span>.</p>

<p>The piston rings data set is used to illustrate the calculation of the capability indices using the <code><a href="../reference/qcs.cp.html">qcs.cp()</a></code> function based on the expressions previously described in the Table . From the statistics obtained from the <span class="math inline">\(\bar{x}\)</span> control chart of pistonrings dataset, the <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\beta\)</span> values are estimated and the corresponding capability index is computed</p>
<p><code>R&gt; data("pistonrings")</code></p>
<p><code>R&gt; xbar &lt;- qcs.xbar(pistonrings[1:125, ], plot = FALSE)</code></p>
<p><code>R&gt; limits &lt;- c(lsl = 73.99, usl = 74.01)</code></p>
<p><code>R&gt; # qcs.cp(object = xbar, parameters = c(0, 0), limits = limits, contour = FALSE)</code></p>
<p><code>R&gt; # qcs.cp(object = xbar, parameters = c(1, 0), limits = limits, contour = FALSE)</code></p>
<p><code>R&gt; # qcs.cp(object = xbar, parameters = c(0, 1), limits = limits, contour = FALSE)</code></p>
<p><code>R&gt; qcs.cp(object = xbar, parameters = c(1, 1), limits = limits, contour = FALSE)</code></p>
<pre><code><span class="co">#&gt;        Cp delta.usl gamma.usl </span>
<span class="co">#&gt;    0.3407    0.1176    0.9785</span>
<span class="co">#&gt;       Cpk delta.usl gamma.usl </span>
<span class="co">#&gt;    0.3006    0.1176    0.9785</span>
<span class="co">#&gt;       Cpm delta.usl gamma.usl </span>
<span class="co">#&gt;    0.3382    0.1176    0.9785</span>
<span class="co">#&gt;      Cpmk delta.usl gamma.usl </span>
<span class="co">#&gt;    0.2984    0.1176    0.9785</span></code></pre>
<p>Consequently, the obtained results are <span class="math inline">\(C_p = 0.3407, C_{pk} = 0.3006, C_{pm} = 0.3382,~~ \mbox{and}~~ C_{pmk} = 0.2984\)</span>, respectively. The argument parameters accounts for the <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> values, while object is the type of control chart from which the <span class="math inline">\(\sigma\)</span> is estimated, limits are the specification control limits, and contour the parameter that indicates when the process capability contour chart is plotted.</p>
</div>
<div class="section level3">
<h3 id="process-capability-plot">Process capability plot<a class="anchor" aria-label="anchor" href="#process-capability-plot"></a>
</h3>
<p>In Vännman  and Deleryd and Vännman , a graphical method (based on common capbility indices) to analyze the capability of a process is proposed. The goal of using this type of plot (if compared with respect to only capability indices calculation) is to provide immediate information of the location and spread of the CTQ feature, and about the capability to meet the specifications of the corresponding process. When using this chart, a process will be <em>capable</em> if the process capability index is higher than a certain value <span class="math inline">\(k\)</span>, with <span class="math inline">\(k &gt; 1\)</span>. The most used values for <span class="math inline">\(k\)</span> are <span class="math inline">\(k = 1, k = 4/3\)</span>, or <span class="math inline">\(k = \frac{5}{3}\)</span>, even 2 at a Six Sigma level, taking into account the usual index limits for which a process could be assumed <em>capable</em>. It will also be assumed that the target value matches the center of the specification interval, that is, <span class="math inline">\(T=\frac{(USL+LSL)}{2}=m\)</span>. Then, one of the indices defined by the <span class="math inline">\(C_p(u, v)\)</span> family is used, e.g., <span class="math inline">\(C_{pk}\)</span> or <span class="math inline">\(C_{pm}\)</span>, and the process will be defined as <em>capable</em> if <span class="math inline">\(C_p(u, v) &gt; k\)</span>, given the values of <span class="math inline">\(u\)</span>, <span class="math inline">\(v\)</span>, and <span class="math inline">\(k\)</span>. Also note that if <span class="math inline">\(\mu = T\)</span>, all the <span class="math inline">\(C_p(u, v)\)</span> indices are defined by the same expression as the <span class="math inline">\(C_p\)</span>. Moreover, different setting for <span class="math inline">\(u\)</span>, <span class="math inline">\(v\)</span>, and <span class="math inline">\(k\)</span> impose different constraints on process parameters <span class="math inline">\((\mu, \sigma)\)</span>. This can be easily seen through a process capability plot. This graph is a contour plot of <span class="math inline">\(C_p(u,v)=k\)</span> as a function of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, but it can also be defined as a function of <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\gamma\)</span> , with <span class="math inline">\(\delta=\frac{\mu-T}{d}\)</span> and <span class="math inline">\(\gamma=\frac{\sigma}{d}\)</span>. The contour line is obtained by rewriting the index <span class="math inline">\(C_p(u,v)\)</span> as a function of <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\gamma\)</span> as follows <span class="math inline">\(C_p(u,v) =\frac{1-u|\delta|}{3\sqrt{\gamma^2+v(\delta)^2}}\)</span>. Therefore, the <span class="math inline">\(C_p(u,v) = k\)</span> equation is solved, plotting <span class="math inline">\(\gamma\)</span> depending on the values of <span class="math inline">\(\delta\)</span>. The resulting expressions are: <span class="math display">\[\begin{align*}
\gamma=\sqrt{\frac{(1-u|\delta|)}{9k^2}-v\delta^2},~~|\delta|\leq\frac{1}{u+3k\sqrt{v}},~~ (u,v)\neq(0,0)
\end{align*}\]</span> When <span class="math inline">\(u = v = 0\)</span>, that is, when we consider the index <span class="math inline">\(C_p = k\)</span>, we have <span class="math inline">\(\gamma= \frac{1}{3k}\)</span>, and <span class="math inline">\(|\delta|\leq 1\)</span>. It is important to highlight that the axis accounts for the process spread, whereas the <span class="math inline">\(\delta\)</span> axis accounts for the process location. The values of the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> which provide values <span class="math inline">\((\delta,\gamma )\)</span> within the region bounded by the contour line <span class="math inline">\(C_p(u,v)=k\)</span> and the <span class="math inline">\(delta\)</span> axis will provide a larger <span class="math inline">\(C_p(u,v)\)</span> value than <span class="math inline">\(k\)</span>, leading a capable process. Furthermore, values of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> which provide values <span class="math inline">\((\delta,\gamma )\)</span> outside this region will provide a value <span class="math inline">\(C_p(u,v)\)</span> smaller than <span class="math inline">\(k\)</span>, i.e., a non-capable process. In the case of the process not being capable, this type of plot is useful to understand if the corrective actions have to be performed to decrease the process spread, or the process location (deviation with respect to target) or even when both changes are needed to improve the process capability. This can be observed by observing the distance with respect to the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axis. Below are some examples of capability plot application which can be generated through the application of the <code>qcs.cp</code> function with <code>contour=TRUE</code> and <code>k=1</code> (default values)</p>
<p><code>R&gt; oldpar &lt;- par(mfrow = c(2, 2))</code></p>
<p><code>R&gt; qcs.cp(object = xbar, parameters = c(0, 0), limits = limits, ylim = c(0, 1))</code></p>
<p><code>R&gt; qcs.cp(object = xbar, parameters = c(1, 0), limits = limits, ylim = c(0, 1))</code></p>
<p><code>R&gt; qcs.cp(object = xbar, parameters = c(0, 1), limits = limits, ylim = c(0, 1))</code></p>
<p><code>R&gt; qcs.cp(object = xbar, parameters = c(1, 1), limits = limits, ylim = c(0, 1))</code></p>
<p><code>R&gt; par(oldpar)</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-21-1.png" width="60%" style="display: block; margin: auto;"></p>
<pre><code><span class="co">#&gt;        Cp delta.usl gamma.usl </span>
<span class="co">#&gt;    0.3407    0.1176    0.9785</span></code></pre>
<p><img src="en_material_files/figure-html/unnamed-chunk-21-2.png" width="60%" style="display: block; margin: auto;"></p>
<pre><code><span class="co">#&gt;       Cpk delta.usl gamma.usl </span>
<span class="co">#&gt;    0.3006    0.1176    0.9785</span></code></pre>
<p><img src="en_material_files/figure-html/unnamed-chunk-21-3.png" width="60%" style="display: block; margin: auto;"></p>
<pre><code><span class="co">#&gt;       Cpm delta.usl gamma.usl </span>
<span class="co">#&gt;    0.3382    0.1176    0.9785</span></code></pre>
<p><img src="en_material_files/figure-html/unnamed-chunk-21-4.png" width="60%" style="display: block; margin: auto;"></p>
<pre><code><span class="co">#&gt;      Cpmk delta.usl gamma.usl </span>
<span class="co">#&gt;    0.2984    0.1176    0.9785</span></code></pre>
<p>The result is shown in Figure . In all the cases the points in red are out of the area defined by the line in blue and the <span class="math inline">\(\delta\)</span> axis. Thus, the corresponding process is not capable no matter the capability index that is used. In any case, note that the <span class="math inline">\(C_p\)</span> index is useless in identifying non capable processes due to location shifts with respect to the target. In the same way, the <span class="math inline">\(C_pk\)</span> index assumes as capable processes that are far from the target as long as it were close to the specification limits (as shown in Figure ). Thus, the use of the <span class="math inline">\(C_{pm}\)</span> and <span class="math inline">\(C_{pmk}\)</span> are recommended due to they take into account both shifts from the target and the spread. In the present case the process is not capable due to the spread rather than the target shift. Therefore, the process changes could be due to decreases in the variability process.</p>
</div>
<div class="section level3">
<h3 id="estimated-process-capability-plot">
<em>Estimated process capability plot</em><a class="anchor" aria-label="anchor" href="#estimated-process-capability-plot"></a>
</h3>
<p>In practice, the process parameters are unknown and we need to estimate them. We can perform a decision rule based on the sample statistics that provide a sample estimate of the capability index and, finally the so called estimated process capability plot, also called <span class="math inline">\(\gamma^*-\delta^*\)</span> plot . It allows us to decide whether a process is capable or not assuming that <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> parameters are unknown and estimated by <span class="math inline">\(\hat{\mu}=\bar{X}\)</span> and <span class="math inline">\(\hat{\sigma}^2=\frac{1}{n}\displaystyle\sum_{i=1}^{n}\left(X_i^2-\bar{X}^2\right)\)</span>. They are the maximum likelihood estimators when the CTQ variable of the process is normally distributed, and <span class="math inline">\(X_1,X_2, . . . ,X_n\)</span> a random sample of a normal distribution with <span class="math inline">\(\mu\)</span> mean and <span class="math inline">\(\sigma^2\)</span> variance.</p>
<p>The <code>qcr</code> package only provides the <span class="math inline">\(\gamma^*-\delta^*\)</span> plot corresponding to the <span class="math inline">\(C_{pm}\)</span> index taking into account that the other capability indices do not consider shifts from the target value in their calculations. For the general case, see the work of . In order to obtain an appropriate decision rule for the case of <span class="math inline">\(C_{pm}\)</span> index, we test the hypotheses <span class="math inline">\(H_0 : C_{pm} \leq k_0\)</span> versus <span class="math inline">\(H_1 : C_{pm} &gt; k_0\)</span>, using <span class="math display">\[\begin{align*}
\hat{C}_{pm}=\frac{d}{3\sqrt{\hat{\sigma}^2+(\hat{\mu}-T)^2}}
\end{align*}\]</span> as test statistic. The null hypothesis will be rejected if <span class="math inline">\(\hat{C}_{pm}&gt;c_\alpha\)</span>, where the constant <span class="math inline">\(c_\alpha\)</span> is determined by previously defining a signifition test level <span class="math inline">\(\alpha\)</span>. Vännman [40] showed that the null hypothesis <span class="math inline">\(H_0 : C_{pm}\leq k_0\)</span> can be reduced to <span class="math inline">\(H_0 : C_{pm} = k_0\)</span>. Thus, for given values of <span class="math inline">\(alpha\)</span> and <span class="math inline">\(n\)</span>, the process will be considered capable if <span class="math inline">\(\hat{C}_{pm}&gt;c_\alpha\)</span>, with <span class="math inline">\(c_{\alpha} &gt; k_0\)</span>. Hubele and Vännman [42] proved that, when the <span class="math inline">\(C_{pm}\)</span> index is used, the critical value for a given <span class="math inline">\(\alpha\)</span> is obtained as <span class="math display">\[\begin{align*}
c_{\alpha}=k_0\sqrt{\frac{n}{\chi_{\alpha,n}^2}}
\end{align*}\]</span> where <span class="math inline">\(\chi_{\alpha,n}^2\)</span> is the quantile <span class="math inline">\(\alpha\)</span> of a <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\(n\)</span> degrees of freedom. The <code>qcr</code> package includes <code>the qcs.hat.cpm()</code> function to obtain both the theoretical capability plot and the estimated capability plot from sample statistics. Among other options, the user can indicate the control chart from which the estimates <span class="math inline">\(\hat{\mu}\)</span> and <span class="math inline">\(\hat{\sigma}\)</span> are obtained (alternatively, <span class="math inline">\(\hat{\mu}\)</span> and <span class="math inline">\(\hat{\sigma}\)</span> can be introduced through <code>mu</code> and <code>std.dev</code>), and the specification limits using limits. Furthermore, the signification level and the capability limit can be modified, as they are set to <span class="math inline">\(\alpha\)</span> = 0.05 and <span class="math inline">\(k_0 = 1\)</span> by default. The following code illustrates its application to <code>pistonrings data</code></p>
<p><code>R&gt; xbar &lt;- qcs.xbar(pistonrings[1:125, ], plot = FALSE)</code></p>
<p><code>R&gt; limits &lt;- c(lsl = 73.99, usl = 74.01)</code></p>
<p><code>R&gt; # qcs.hat.cpm(object = xbar, limits = limits, ylim = c(0,1))</code></p>
<p><code>R&gt; mu &lt;- xbar$center</code></p>
<p><code>R&gt; std.dev &lt;- xbar$std.dev</code></p>
<p><code>R&gt; qcs.hat.cpm(limits = limits, mu = mu, std.dev = std.dev, ylim = c(0,1))</code></p>
<p><img src="en_material_files/figure-html/unnamed-chunk-22-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>The result is shown in Figure . The contour line corresponding to the capability region obtained from the capability index sample is always more restrictive than the corresponding theoretical one.</p>
</div>
<div class="section level3">
<h3 id="nonparametric-capability-analysis">
<em>Nonparametric capability analysis</em><a class="anchor" aria-label="anchor" href="#nonparametric-capability-analysis"></a>
</h3>
<p>Traditional assumptions about data such as normality or independence are frequently violated in many real situations. Thus, in scenarios in which assumptions of normality are not verified, the indices defined in the previous sections are not valid. Pearn and Chen  and Tong and Chen  proposed generalizations of <span class="math inline">\(C_p(u,v)\)</span> for the case of arbitrary distributions of data <span class="math display">\[\begin{align*}
C_{Np}(u,v)=\frac{d-u|M-m|}{3\sqrt{\left(\frac{F_{99,865}-F_{0,135}}{6}\right)^2+v(M-T)^2}}
\end{align*}\]</span> where <span class="math inline">\(F_{\alpha}\)</span> is the percentile <span class="math inline">\(\alpha\)</span>% of the corresponding distribution and <span class="math inline">\(M\)</span> the median of the process. However, the distribution of the underlying process is always unknown.  calculated estimates for <span class="math inline">\(F_{99.865}\)</span>, <span class="math inline">\(F_{0.135}\)</span> and <span class="math inline">\(M\)</span> based on the sample percentiles.</p>
<p>Pearn and Chen  proposed the following estimator <span class="math display">\[\begin{align*}
\hat{C}_{Np}(u,v)=\frac{d-u|\hat{M}-m|}{3\sqrt{\left(\frac{U_p-L_p}{6}\right)^2+v(\hat{M}-T)^2}}
\end{align*}\]</span> where Up is an estimator for <span class="math inline">\(F_{99.865}\)</span>, Lp is an estimator for <span class="math inline">\(F_{0.135}\)</span> and <span class="math inline">\(\hat{M}\)</span> is an estimator for <span class="math inline">\(M\)</span>, obtained from the tables developed by . The <code><a href="../reference/qcs.cpn.html">qcs.cpn()</a></code> function of <code>qcr</code> calculates <span class="math inline">\(CN_p, CN_{pk}, CN_{pm}~~\mbox{and}~~CN_{pmk}\)</span> using the formulation described by Tong and Chen . The code that illustrates its use is shown below. To obtain the nonparametric capability indices it is necessary to indicate the <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> parameters.</p>
<p><code>R&gt; xbar &lt;- qcs.xbar(pistonrings[1:125, ], plot = FALSE)</code></p>
<p><code>R&gt; limits &lt;- c(lsl = 73.99, usl = 74.01)</code></p>
<p><code>R&gt; # x &lt;- xbar$statistics[[1]]</code></p>
<p><code>R&gt; # median &lt;- median(x)</code></p>
<p><code>R&gt; # q = quantile(x, probs = c(0.00135, 0.99865)) # c(lq, uq)</code></p>
<p><code>R&gt; # qcs.cpn(parameters = c(0, 0), limits = limits, median = median, q = q)</code></p>
<p><code>R&gt; qcs.cpn(object = xbar, parameters = c(0, 0), limits = limits)</code></p>
<p><code>R&gt; qcs.cpn(object = xbar, parameters = c(1, 0), limits = limits)</code></p>
<p><code>R&gt; qcs.cpn(object = xbar, parameters = c(0, 1), limits = limits)</code></p>
<p><code>R&gt; qcs.cpn(object = xbar, parameters = c(1, 1), limits = limits)</code></p>
<pre><code><span class="co">#&gt;    CNp </span>
<span class="co">#&gt; 1.0082</span>
<span class="co">#&gt;   CNpk </span>
<span class="co">#&gt; 0.9275</span>
<span class="co">#&gt;   CNpm </span>
<span class="co">#&gt; 0.9799</span>
<span class="co">#&gt;  CNpmk </span>
<span class="co">#&gt; 0.9015</span></code></pre>
<p>Thus, the values obtained are <span class="math inline">\(CN_p = 1.0082, CN_{pk} = 0.9275, CN_{pm} = 0.9799~\mbox{and}~CN_{pmk} = 0.9015\)</span>. If a capability limit of <span class="math inline">\(k = 1\)</span> or <span class="math inline">\(k = 1.33\)</span> is assumed, we can infer that the process is not actually capable to meet the customers or manager’s requirements. ## <em>Tools for a comprehensive processs capability analysis</em> Function <code><a href="../reference/qcs.ca.html">qcs.ca()</a></code> provides a comprehensive information of the capability of a process, summarized trough a graphica output. This function calculates the process capability indices <span class="math inline">\(C_p, C_{pk}, C_{pL}, C_{pU}, C_{pm}, C_{pmk}\)</span> from a <code>qcs</code> object, assuming a Gaussian distribution. Moereover, it computes confidence limits for <span class="math inline">\(C_p\)</span> using the method described by Chou <em>et al</em>. . Approximate confidence limits for <span class="math inline">\(C_{pl}, C_{pu} ~\mbox{and}~ C_{pk}\)</span> are also estimated using the method described in Bissell , while the confidence limits for <span class="math inline">\(C_{pm}\)</span> are based on the aproximated method of Boyles , that assumes the target is the mean of the specification limits. Moreover, the <span class="math inline">\(CN_{p}, CN_{pk}, CN_{pm}, ~\mbox{and}~ CN_{pmk}\)</span> nonparametric capability indices are also obtained. There is also an specific box within the summary plot that shows the proportion of observations, and expected observations under the Gaussian assumption, out of the specification limits (nonconforming observations). Further, a histogram of data sample is provided, in addition to the corresponding Gaussian density curves obtained from the sample estimates (one per standard deviation estimate procedure). They are displayed along with the specification limits, a quantile-quantile plot for the specified distribution and a process capability plot obtained from the Cpm index (both using theoretical and sample alternatives). In order to describe the <code><a href="../reference/qcs.ca.html">qcs.ca()</a></code> performance, the following code corresponds to the analysis of the first 125 observations of the pistonrings dataset (the corresponding output is shown in Figure ).</p>
<p><img src="en_material_files/figure-html/unnamed-chunk-24-1.png" width="60%" style="display: block; margin: auto;"></p>
<pre><code><span class="co">#&gt; </span>
<span class="co">#&gt; Process Capability Analysis</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; qcs.ca(object = xbar, limits = c(lsl = 73.99, usl = 74.01))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of obs = 125          Target = 74</span>
<span class="co">#&gt;        Center =  74               LSL =  73.99</span>
<span class="co">#&gt;        StdDev =  0.009785         USL =  74.01</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Paremetric Capability indices:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Value    0.1%   99.9%</span>
<span class="co">#&gt; Cp    0.3407  0.2771  0.4065</span>
<span class="co">#&gt; Cp_l  0.3807  0.2739  0.4875</span>
<span class="co">#&gt; Cp_u  0.3006  0.2021  0.3991</span>
<span class="co">#&gt; Cp_k  0.3006  0.1944  0.4068</span>
<span class="co">#&gt; Cpm   0.3382  0.2749  0.4038</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Non parametric Capability indices:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Value</span>
<span class="co">#&gt; CNp    1.0082</span>
<span class="co">#&gt; CNpK   0.9275</span>
<span class="co">#&gt; CNpm   0.9799</span>
<span class="co">#&gt; CNpmk  0.9015</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; PPM:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          Exp&lt;LSL 1.267e+07       Obs&lt;LSL 0</span>
<span class="co">#&gt;          Exp&gt;USL 1.836e+07       Obs&gt;USL 8e+05</span>
<span class="co">#&gt;        Exp Total 3.103e+07     Obs Total 8e+05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Anderson Darling Test for normal distribution</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  xbar </span>
<span class="co">#&gt; A = 0.1399, mean = 74.001, sd = 0.005, p-value = 0.9694</span>
<span class="co">#&gt; alternative hypothesis: true distribution is not equal to normal</span></code></pre>
<p><code>R&gt; qcs.ca(xbar, limits = c(lsl = 73.99, usl = 74.01))</code></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>The <code>qcr</code> package has been developed to provide users with a comprehensive set of functions that manage statistical process control, ranging from univariate parametric analysis to multivariate nonparametric statistics. This package includes the main types of control charts and capability indices. It combines the main features of reputed <code>SQC</code> packages in <code>R</code> such as <code>qcc</code> and qualityTools with the proposal of a new graphical appearance and the implementation of new <code>SQC</code> tools with increasing importance in Industry 4.0 such as multivariate and nonparametric analysis. In addition to some utilities provided by reference <code>R</code> packages such as <code>qcc</code>, <code>SixSigma</code> and <code>qualityTools</code>, <code>qcr</code> implements very important statistical techniques of Control and Analysis tasks of the Six Sigma procedure that are not included in other libraries. In the case of control charts, these tools are the MEWMA and MCUSUM multivariate control charts, on the one hand, and the <span class="math inline">\(r\)</span>, <span class="math inline">\(Q\)</span> and <span class="math inline">\(S\)</span> nonparametric control charts (for univariate and multivariate cases) based on data depth, on the other hand. It is also very important to note that <code>qcr</code> provides functions to perform nonparametric capability analysis. In addition, the new implementation of the process capability plots for the main parametric capability indices allows us to analyze if improvements in process spread or/and process location are needed to obtain a capable process. The comparison between suppliers, machines, etc., is enabled through capability plots. The <code>qcr</code> package also includes an automatic way to delete out of control states in the process of chart natural control limits estimation. All these utilities intend to make <code>qcr</code> a useful <code>tool</code> for users of a wide variety of industries, providing a competitive alternative to commercial software.</p>

<p>This study has been founded by the eCOAR project (PC18/03) of CITIC. In addition, the work of Salvador Naya, Javier Tarrío-Saavedra, Miguel Flores and Rubén Fernéndez-Casal has been supported by MINECO grants MTM2014-52876-R, MTM2017-82724-R, the Xunta de Galicia (Grupos de Referencia Competitiva ED431C-2016-015, and Centro Singular de Investigación de Galicia ED431G/01 2016-19), through the ERDF. The research of Miguel Flores has been partially supported by Grant PII-DM-002-2016 of Escuela Politécnica Nacional of Ecuador. The authors thank Mateo Larco and Bibiana Santiso for their valuable help with the English edition.</p>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Pande, P.S.; Neuman, R.P.; Cavanagh, R.R. The six sigma way: How GE, Motorola, and other top companies are honing their performance; McGraw-Hill (New York), 2000.</p></li>
<li><p>Montgomery, D.C. Introduction to statistical quality control; John Wiley &amp; Sons (New York), 2009. Champ, C.W.; Woodall, W.H. Exact results for Shewhart control charts with supplementary runs rules.Technometrics 1987, 29, 393-399.</p></li>
<li><p>Liu, R.Y. Control charts for multivariate processes. Journal of the American Statistical Association 1995, 90, 1380-1387.</p></li>
<li><p>Boyles, R.A. The Taguchi capability index. Journal of Quality Technology 1991, 23, 17-26. Polansky, A.M. Process Capability Indices, Nonparametric. Encyclopedia of Statistics in Quality and Reliability 2007.</p></li>
<li><p>R Core Team. R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria, 2018.</p></li>
<li><p>Scrucca, L. qcc: an R package for quality control charting and statistical process control. R News 2004, 4/1, 11-17.</p></li>
<li><p>Barros, F. IQCC: Improved Quality Control Charts, 2017. R package version 0.7.</p></li>
<li><p>Roth, T. qualityTools: Statistics in Quality Science., 2016. R package version 1.55 <a href="http://www.r-qualitytools.org" class="external-link uri">http://www.r-qualitytools.org</a>.</p></li>
<li><p>Cano, E.L.; Moguerza, J.M.; Redchuk, A. ; Vol. 36, Use R!, Springer-Verlag: New York, 2012.</p></li>
<li><p>Cano, E.L.; Moguerza, J.M.; Corcoba, M.P. ; Use R!, Springer-Verlag: New York, 2015.</p></li>
<li><p>Gandy, A.; Kvaloy, J.T. Guaranteed Conditional Performance of Control Charts via Bootstrap Methods. 2013, , 647-668. <a href="doi:10.1002/sjos.12006" class="uri">doi:10.1002/sjos.12006</a>.</p></li>
<li><p>Knoth, S. , 2018. R package version 0.6.0.</p></li>
<li><p>Santos-Fernandez, E. ; Vol. 14, Springer-Verlag, 2013.</p></li>
<li><p>Santos-Fernández, E.; Scagliarini, M. MPCI: An R Package for Computing Multivariate Process Capability Indices.  2012, , 1-15.</p></li>
<li><p>Zhu, W.; Park, C. edcc: An R Package for the Economic Design of the Control Chart.  2013, , 1-24.</p></li>
<li><p>Brown, D.W.; Wetherill, G.B. ; Chapman and Hall, 1990.</p></li>
<li><p>Liu, R.Y.; Tang, J. Control charts for dependent and independent measurements based on bootstrap methods.  1996, , 1694-1700.</p></li>
<li><p>Flores, M.; Fernandez-Casal, R.; Naya, S.; Tarrio-Saavedra, J. , 2016. R package version 1.0.</p></li>
<li><p>Page, E.S. Continuous inspection schemes.  1954, , 100-115.</p></li>
<li><p>Roberts, S. Control chart tests based on geometric moving averages.  1959, , 239-250.</p></li>
<li><p>Woodall, W.H. Controversies and contradictions in statistical process control.  2000, 32, 341-350.</p></li>
<li><p>Alt, F.B.; Smith, N.D. 17 multivariate process control.  1988, , 333-351.</p></li>
<li><p>Woodall, W.H.; Ncube, M.M. Multivariate CUSUM quality-control procedures.  1985, , 285-292.</p></li>
<li><p>Healy, J.D. A note on multivariate CUSUM procedures.  1987, , 409-412.</p></li>
<li><p>Hawkins, D.M. Multivariate quality control based on regression-adiusted variables.  1991, , 61-75.</p></li>
<li><p>Crosier, R.B. Multivariate generalizations of cumulative sum quality-control schemes.  1988, , 291-303.</p></li>
<li><p>Pignatiello, J.J.; Runger, G.C. Comparisons of multivariate CUSUM charts.  1990, , 173-186.</p></li>
<li><p>Lowry, C.A.; Woodall, W.H.; Champ, C.W.; Rigdon, S.E. A multivariate exponentially weighted moving average control chart.  1992, , 46-53.</p></li>
<li><p>Runger, G.C.; Prabhu, S.S. A Markov chain model for the multivariate exponentially weighted moving averages control chart.  1996, 91, 1701-1706.</p></li>
<li><p>Dyckerhoff, R. Data depths satisfying the projection property.  2004,, 163-190.</p></li>
<li><p>Cascos, I.; López, A.; Romo, J. Data depth in multivariate statistics.  2011, , 151-174.</p></li>
<li><p>Liu, R.Y.; others. On a notion of data depth based on random simplices.  1990,, 405-414.</p></li>
<li><p>Mahalanobis, P.C. On the generalised distance in statistics. , 1936, pp. 49-55.</p></li>
<li><p>Tukey, J.W. Mathematics and the picturing of data. , 1975, Vol. 2, pp. 523-531.</p></li>
<li><p>Fraiman, R.; Liu, R.Y.; Meloche, J. Multivariate density estimation by probing depth.  1997, pp. 415-430.</p></li>
<li><p>Zuo, Y.; Serfing, R. General notions of statistical depth function.  2000, pp. 461-482.</p></li>
<li><p>Vännman, K. A unified approach to capability indices.  1995, pp. 805-820.</p></li>
<li><p>Vännman, K. A graphical method to control process capability. ; Springer-Verlag, 2001; pp. 290-311.</p></li>
<li><p>Deleryd, M.; Vännman, K. Process capability plots-a quality improvement tool.  1999, , 213-227.</p></li>
<li><p>Hubele, N.F.; Vannman, K. The Efect of Pooled and Un-pooled Variance Estimators on <span class="math inline">\(\hat{C}\)</span> sub <span class="math inline">\(\hat{pn}\)</span> When Using Subsamples.  2004, , 207.</p></li>
<li><p>Pearn, W.; Chen, K. A practical implementation of the process capability index Cpk. 1997, , 721-737.</p></li>
<li><p>Tong, L.I.; Chen, J.P. Lower confidence limits of process capability indices for non-normal process distributions.  1998, , 907-919.</p></li>
<li><p>Chang, P.L.; Lu, K.H. PCI calculations for any shape of distribution with percentile.  1994, pp. 110-114.</p></li>
<li><p>Gruska, G.; Mirkhani, K.; Lamberson, L. Non Normal Data Analysis. St. Clair Shores, MI:  1989.</p></li>
<li><p>Chou, Y.M.; Owen, D.; Borrego A, S. Lower confidence limits on process capability indices.  1990, , 223-229.</p></li>
<li><p>Bissell, A. How reliable is your capability index?  1990, pp. 331-340. \end{thebibliography}</p></li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Miguel Flores, Ruben Fernandez-Casal, Salvador Naya, Javier Tarrio-Saavedra.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
